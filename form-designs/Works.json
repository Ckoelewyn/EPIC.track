{"forms":[{"title":"Works","display":"form","type":"form","name":"work","path":"work","tags":["common"],"components":[{"title":"Work Details","collapsible":false,"key":"work","type":"panel","label":"Panel","input":false,"tableView":false,"components":[{"label":"reportApiUrl","defaultValue":"https://eao-reports.apps.devops.aot-technologies.com/api/v1/","persistent":false,"customDefaultValue":"var urls = localStorage.getItem('customApiUrl').split(',');\nvalue = urls[0];\ninstance.setValue(urls[0]);","key":"reportapiurl","type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"protected":false,"unique":false,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"ehtxe3"},{"label":"onLoad","persistent":false,"customDefaultValue":"try{\nvar headers = {headers: {\n  Authorization: 'Bearer '+localStorage.getItem('authToken')\n}\n}\nvar currentValue = value || {\n  \"dateFormat\": \"YYYY-MM-DD\",\n  \"hasValue\": (value) => {\n    if(value !== undefined && value !== \"\") return value;\n    else return false;\n  },\n  \"addEventListener\": (element,eventName, handler) =>{\n    if(element) {\n      var events = element.getAttribute('events') || [];\n      if(!events.includes(eventName)) {\n        element.addEventListener(eventName, handler);\n          events.push(eventName);\n        element.setAttribute('events',events);\n      }\n}\n  }\n};\nvar url = data.reportapiurl || localStorage.getItem('customApiUrl').split(',')[0];\nfetch(url+'staffs',headers).then(response=>response.json())\n.then(data=>{\n  currentValue = {\n    ...currentValue,\n    \"staffs\": data.staffs\n  }\n   instance.setValue(currentValue);\n});\nfetch(url+'codes/outcomes',headers).then(response=>response.json())\n.then(data=>{\n  currentValue = {\n    ...currentValue,\n    \"outcomes\": data.codes\n  }\n  instance.setValue(currentValue);\n});\n// setting the activephase to nextphase on reload\nvar activePhaseInterval = setInterval(function(){\n  if(data.actionType!=undefined) {\n    clearInterval(activePhaseInterval);\n      data.activephase = data.actionType;\n  }\n},10);\n}catch(e) {\n  console.error('Error from onload',e.message);\n}","key":"onload","logic":[{"name":"submitEventLogic","trigger":{"type":"event","event":"submitEvent1"},"actions":[{"name":"submitEventAction","type":"customAction","customAction":"\ntry{\n  var overlayContent = '<div data-testid=\"overlay\" class=\"_loading_overlay_overlay css-1mm12ec _loading-overlay-transition-enter-done\"><div class=\"_loading_overlay_content css-42igfv\"></div></div>';\n  var wrapper = document.querySelector(\"[data-testid='wrapper']\");\n  var overlayElement = document.createElement('div');\n  overlayElement.innerHTML = overlayContent;\n  overlayElement = overlayElement.firstChild;\n  overlayElement.style.position = 'absolute';\n  overlayElement.style.height = '100%';\n  overlayElement.style.width = '100%';\n  overlayElement.style.top = '0px';\n  overlayElement.style.left = '0px';\n  overlayElement.style.display = 'flex';\n  overlayElement.style.fontSize = '1.2em';\n  overlayElement.style.color = 'rgb(255, 255, 255)';\n  overlayElement.style.textAlign = 'center';\n  overlayElement.style.background = 'rgba(0, 0, 0, 0.2)';\n  overlayElement.style.zIndex = '800';\n  overlayElement.style.transition = 'opacity 500ms ease-in 0s';\n  overlayElement.style.opacity = '1'\n  overlayElement.style.cursor = 'not-allowed';\n  wrapper.appendChild(overlayElement);  \n  var button = document.querySelector(\"[name='data[alternatesubmit]']\");\n  button.setAttribute('disabled','disabled');\n}catch(e) {\n  console.warn('Error from custom action, submitEventLogic',e.message);\n}\t\t"}]}],"type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"evsxwtd"},{"label":"Columns","columns":[{"components":[{"label":"Project","widget":"choicesjs","tableView":true,"dataSrc":"url","data":{"url":"{{data.reportapiurl}}projects","headers":[{"key":"Authorization","value":"Bearer {{localStorage.getItem('authToken')}}"}],"values":[{"label":"","value":""}],"json":"","resource":"","custom":""},"valueProperty":"id","template":"<span>{{ item.name }}</span>","validate":{"required":true,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"onlyAvailableItems":false},"key":"works.project_id","type":"select","selectValues":"projects","input":true,"lazyLoad":false,"disableLimit":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"idPath":"id","clearOnRefresh":false,"limit":100,"filter":"","searchEnabled":true,"searchDebounce":0.3,"searchField":"","minSearch":0,"readOnlyValue":false,"authenticate":false,"ignoreCache":false,"selectFields":"","selectThreshold":0.3,"uniqueOptions":false,"fuseOptions":{"include":"score","threshold":0.3},"indexeddb":{"filter":{}},"customOptions":{},"useExactSearch":false,"id":"ef8yo2"},{"label":"Worktype","widget":"choicesjs","tableView":true,"dataSrc":"url","data":{"url":"{{data.reportapiurl}}codes/work_types","headers":[{"key":"Authorization","value":"Bearer {{localStorage.getItem('authToken')}}"}],"values":[{"label":"","value":""}],"json":"","resource":"","custom":""},"dataType":"string","valueProperty":"id","limit":1000,"template":"<span>{{ item.name }}</span>","customDefaultValue":"var element = document.querySelector(\"[name='data[works.work_type_id]']\");\ndata.onload.addEventListener(element,'change',(event)=>{\n  instance.emit('onPhaseGridChanged',{});\n});\n\n","validate":{"required":true,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"onlyAvailableItems":false},"key":"works.work_type_id","type":"select","selectValues":"codes","input":true,"disableLimit":false,"eaactworktypestartdate":"undefinedundefined","placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"idPath":"id","clearOnRefresh":false,"lazyLoad":true,"filter":"","searchEnabled":true,"searchDebounce":0.3,"searchField":"","minSearch":0,"readOnlyValue":false,"authenticate":false,"ignoreCache":false,"selectFields":"","selectThreshold":0.3,"uniqueOptions":false,"fuseOptions":{"include":"score","threshold":0.3},"indexeddb":{"filter":{}},"customOptions":{},"useExactSearch":false,"id":"ei2bjl2"},{"label":"start_date","persistent":false,"key":"start_date","properties":{"someproperty":"somevalue"},"type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"eet5kcb"},{"label":"eventState","calculateValue":"value = value || [];","key":"eventstate","type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"ecjy63"},{"label":"id","key":"works.id","type":"hidden","input":true,"tableView":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"ejid91s"},{"label":"currentPhaseId","customDefaultValue":"\r\n\r\nvar interval = setInterval(function(){\r\n  var phases = submission.data['works-work_phases'];\r\n  if(phases.length>0) {\r\n    var currentPhaseIndex = submission.data.actionType;\r\n    var currentPhase = phases[currentPhaseIndex];\r\n    instance.setValue(currentPhase.phase_id);\r\n    clearInterval(interval);\r\n  }\r\n},100);\r\n","key":"works.current_phase_id","type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"eka11ir"},{"label":"Ministry","widget":"choicesjs","tableView":true,"dataSrc":"url","data":{"url":"{{data.reportapiurl}}codes/ministries","headers":[{"key":"Authorization","value":"Bearer {{localStorage.getItem('authToken')}}"}],"values":[{"label":"","value":""}],"json":"","resource":"","custom":""},"valueProperty":"id","template":"<span>{{ item.combined }}</span>","validate":{"required":true,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"onlyAvailableItems":false},"key":"works.ministry_id","type":"select","selectValues":"codes","input":true,"disableLimit":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"idPath":"id","clearOnRefresh":false,"limit":100,"lazyLoad":true,"filter":"","searchEnabled":true,"searchDebounce":0.3,"searchField":"","minSearch":0,"readOnlyValue":false,"authenticate":false,"ignoreCache":false,"selectFields":"","selectThreshold":0.3,"uniqueOptions":false,"fuseOptions":{"include":"score","threshold":0.3},"indexeddb":{"filter":{}},"customOptions":{},"useExactSearch":false,"id":"ek4dxtw"}],"width":6,"offset":0,"push":0,"pull":0,"size":"md","currentWidth":6},{"components":[{"label":"EA Act","widget":"choicesjs","tableView":true,"dataSrc":"url","data":{"url":"{{data.reportapiurl}}codes/ea_acts","headers":[{"key":"Authorization","value":"Bearer {{localStorage.getItem('authToken')}}"}],"values":[{"label":"","value":""}],"json":"","resource":"","custom":""},"valueProperty":"id","template":"<span>{{ item.name }}</span>","customDefaultValue":"var element = document.querySelector(\"[name='data[works.ea_act_id]']\");\ndata.onload.addEventListener(element,'change',(event)=>{\n  instance.emit('onPhaseGridChanged',{});\n});\n\n","validate":{"required":true,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"onlyAvailableItems":false},"key":"works.ea_act_id","logic":[{"name":"phaseGridChangeLogic","trigger":{"type":"event","event":"change"},"actions":[{"name":"phaseGridChangeAction","type":"customAction","customAction":"console.log('SUBMISSION DATA', submission.data);"}]}],"type":"select","selectValues":"codes","input":true,"disableLimit":false,"eaactworktypestartdate":"undefinedundefined","placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"idPath":"id","clearOnRefresh":false,"limit":100,"lazyLoad":true,"filter":"","searchEnabled":true,"searchDebounce":0.3,"searchField":"","minSearch":0,"readOnlyValue":false,"authenticate":false,"ignoreCache":false,"selectFields":"","selectThreshold":0.3,"uniqueOptions":false,"fuseOptions":{"include":"score","threshold":0.3},"indexeddb":{"filter":{}},"customOptions":{},"useExactSearch":false,"id":"ew84cv"},{"label":"Title","tableView":true,"validate":{"required":true,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":""},"key":"works.title","type":"textfield","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"plain","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false,"id":"efnkrup"},{"label":"Federal Involvement","widget":"choicesjs","tableView":true,"dataSrc":"url","data":{"url":"{{data.reportapiurl}}codes/federal_involvements","headers":[{"key":"Authorization","value":"Bearer {{localStorage.getItem('authToken')}}"}],"values":[{"label":"","value":""}],"json":"","resource":"","custom":""},"valueProperty":"id","template":"<span>{{ item.name }}</span>","validate":{"required":true,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"onlyAvailableItems":false},"key":"works.federal_involvement_id","type":"select","selectValues":"codes","input":true,"disableLimit":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"idPath":"id","clearOnRefresh":false,"limit":100,"lazyLoad":true,"filter":"","searchEnabled":true,"searchDebounce":0.3,"searchField":"","minSearch":0,"readOnlyValue":false,"authenticate":false,"ignoreCache":false,"selectFields":"","selectThreshold":0.3,"uniqueOptions":false,"fuseOptions":{"include":"score","threshold":0.3},"indexeddb":{"filter":{}},"customOptions":{},"useExactSearch":false,"id":"enkeov"}],"width":6,"offset":0,"push":0,"pull":0,"size":"md","currentWidth":6}],"key":"columns1","type":"columns","input":false,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":false,"hidden":false,"clearOnHide":false,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"tree":false,"lazyLoad":false,"autoAdjust":false,"id":"ed0oo4x"},{"label":"Columns","columns":[{"components":[{"label":"Start Date","format":"yyyy-MM-dd","tableView":false,"enableMinDateInput":false,"datePicker":{"disableWeekends":false,"disableWeekdays":false,"datepickerMode":"day","showWeeks":true,"startingDay":0,"initDate":"","minMode":"day","maxMode":"year","yearRows":4,"yearColumns":5,"minDate":null,"maxDate":null},"enableMaxDateInput":false,"enableTime":false,"timePicker":{"showMeridian":false,"hourStep":1,"minuteStep":1,"readonlyInput":false,"mousewheel":true,"arrowkeys":true},"redrawOn":"onload","customDefaultValue":"// console.log('change');\n// var interval = setInterval(()=>{\n//   if(data.onload.addEventListener) {\n//     var element = document.querySelector(\"[name='data[works.start_date]']\").parentElement.children[1];\n//     var attr = element.getAttribute('events');\n//     if(!attr) {\n//         data.onload.addEventListener(element,'input',(event)=>{\n//           console.log('DATE CHANGED',element);\n//           instance.emit('onPhaseGridChanged',{});\n//       });\n//     }else{\n//       //clearInterval(interval);\n//     }\n    \n//   }\n// },10);\n","validate":{"required":true,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"key":"works.start_date","logic":[{"name":"PhaseGridChangedLogic","trigger":{"type":"event","event":"change"},"actions":[{"name":"PhaseGridChangedAction","type":"customAction","customAction":"\nvar startdate = submission.data.works.start_date;\nif(data.onload.hasValue(startdate) && startdate !== submission.data['start_date']) {\nsubmission.data['start_date'] = startdate;\ninstance.emit('onPhaseGridChanged',{});\n}\n\n\n"}]}],"type":"datetime","input":true,"widget":{"type":"calendar","displayInTimezone":"viewer","locale":"en","useLocaleSettings":false,"allowInput":true,"mode":"single","enableTime":false,"noCalendar":false,"format":"yyyy-MM-dd","hourIncrement":1,"minuteIncrement":1,"time_24hr":true,"minDate":null,"disableWeekends":false,"disableWeekdays":false,"maxDate":null},"eaactworktypestartdate":"NaN","placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":"","protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"useLocaleSettings":false,"allowInput":true,"enableDate":true,"defaultDate":"","displayInTimezone":"viewer","timezone":"","datepickerMode":"day","customOptions":{},"id":"efpcht"}],"width":4,"offset":0,"push":0,"pull":0,"size":"md","currentWidth":4},{"components":[{"label":"Anticipated Decision Date","format":"yyyy-MM-dd","disabled":true,"tableView":false,"enableMinDateInput":true,"datePicker":{"disableFunction":"(data.works.start_date.length===0);","disableWeekends":false,"disableWeekdays":false,"datepickerMode":"day","showWeeks":true,"startingDay":0,"initDate":"","minMode":"day","maxMode":"year","yearRows":4,"yearColumns":5,"minDate":null,"maxDate":null},"enableMaxDateInput":false,"enableTime":false,"timePicker":{"showMeridian":false,"hourStep":1,"minuteStep":1,"readonlyInput":false,"mousewheel":true,"arrowkeys":true},"validate":{"custom":"try{\n  var phases = data['works-work_phases'];\n  var phasesCount = phases.length;\n  if(data.works.anticipated_decision_date.length === 0 || phasesCount === 0) {\n    valid = \"Please make sure you have valid phases populated\";\n  }else if(data.works.anticipated_decision_date.length > 0){\n    var phaseEndDate = moment(phases[phasesCount-1].anticipated_end_date);\n    var thisdate = moment(data.works.anticipated_decision_date);\n    var diff = thisdate.diff(phaseEndDate,'days');\n    valid = diff>=0?true:'Anticipated decision date should be equal or higher than the end of date of last phase';\n  }\n}catch(e) {\n  console.log('Error from anticipated decision date: works', e.message);\n}","required":false,"customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"key":"works.anticipated_decision_date","type":"datetime","input":true,"widget":{"type":"calendar","displayInTimezone":"viewer","locale":"en","useLocaleSettings":false,"allowInput":true,"mode":"single","enableTime":false,"noCalendar":false,"format":"yyyy-MM-dd","hourIncrement":1,"minuteIncrement":1,"time_24hr":true,"minDate":null,"disableWeekends":false,"disableWeekdays":false,"disableFunction":"(data.works.start_date.length===0);","maxDate":null},"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":"","protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"useLocaleSettings":false,"allowInput":true,"enableDate":true,"defaultDate":"","displayInTimezone":"viewer","timezone":"","datepickerMode":"day","customOptions":{},"id":"eq8d7tn"}],"width":4,"offset":0,"push":0,"pull":0,"size":"md","currentWidth":4},{"components":[{"label":"Decision Date","format":"yyyy-MM-dd","tableView":false,"enableMinDateInput":false,"datePicker":{"disableWeekends":false,"disableWeekdays":false,"datepickerMode":"day","showWeeks":true,"startingDay":0,"initDate":"","minMode":"day","maxMode":"year","yearRows":4,"yearColumns":5,"minDate":null,"maxDate":null},"enableMaxDateInput":false,"enableTime":false,"key":"works.decision_date","type":"datetime","input":true,"widget":{"type":"calendar","displayInTimezone":"viewer","locale":"en","useLocaleSettings":false,"allowInput":true,"mode":"single","enableTime":false,"noCalendar":false,"format":"yyyy-MM-dd","hourIncrement":1,"minuteIncrement":1,"time_24hr":false,"minDate":null,"disableWeekends":false,"disableWeekdays":false,"maxDate":null},"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":"","protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"useLocaleSettings":false,"allowInput":true,"enableDate":true,"defaultDate":"","displayInTimezone":"viewer","timezone":"","datepickerMode":"day","timePicker":{"hourStep":1,"minuteStep":1,"showMeridian":true,"readonlyInput":false,"mousewheel":true,"arrowkeys":true},"customOptions":{},"id":"erhr0hs"}],"size":"md","width":4,"offset":0,"push":0,"pull":0,"currentWidth":4}],"key":"columns","type":"columns","input":false,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":false,"hidden":false,"clearOnHide":false,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"tree":false,"lazyLoad":false,"autoAdjust":false,"id":"eqzab4r"},{"label":"Short Description","autoExpand":false,"tableView":true,"key":"works.short_description","type":"textarea","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":"","minWords":"","maxWords":""},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"html","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false,"rows":3,"wysiwyg":false,"editor":"","fixedSize":true,"id":"e8tkzel"},{"label":"Long Description","rows":6,"autoExpand":false,"tableView":true,"key":"works.long_description","type":"textarea","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":"","minWords":"","maxWords":""},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"html","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false,"wysiwyg":false,"editor":"","fixedSize":true,"id":"ej8y93"},{"label":"PECP Required","tableView":false,"defaultValue":false,"key":"works.is_pcep_required","type":"checkbox","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":true,"labelPosition":"right","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"checkbox","value":"","name":"","id":"e5ejpxc"},{"label":"CAC Required","tableView":false,"defaultValue":false,"key":"works.is_cac_recommended","type":"checkbox","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":true,"labelPosition":"right","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"checkbox","value":"","name":"","id":"el0nkkq"},{"label":"Columns","columns":[{"components":[{"label":"Short Status","autoExpand":false,"tableView":true,"key":"works.work_short_status","type":"textarea","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":"","minWords":"","maxWords":""},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"html","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false,"rows":3,"wysiwyg":false,"editor":"","fixedSize":true,"id":"esi4ryb"}],"width":8,"offset":0,"push":0,"pull":0,"size":"md","currentWidth":8},{"components":[{"label":"Status Stoplight","widget":"choicesjs","tableView":true,"data":{"values":[{"label":"Red","value":"RED"},{"label":"Yellow","value":"YELLOW"},{"label":"Green","value":"GREEN"}],"json":"","url":"","resource":"","custom":""},"key":"works.work_status_stoplight","type":"select","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"onlyAvailableItems":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"idPath":"id","clearOnRefresh":false,"limit":100,"dataSrc":"values","valueProperty":"","lazyLoad":true,"filter":"","searchEnabled":true,"searchDebounce":0.3,"searchField":"","minSearch":0,"readOnlyValue":false,"authenticate":false,"ignoreCache":false,"template":"<span>{{ item.label }}</span>","selectFields":"","selectThreshold":0.3,"uniqueOptions":false,"fuseOptions":{"include":"score","threshold":0.3},"indexeddb":{"filter":{}},"customOptions":{},"useExactSearch":false,"id":"eng3kih"}],"width":4,"offset":0,"push":0,"pull":0,"size":"md","currentWidth":4}],"key":"columns3","type":"columns","input":false,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":false,"hidden":false,"clearOnHide":false,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"tree":false,"lazyLoad":false,"autoAdjust":false,"id":"e4disis"},{"label":"Active","tableView":false,"key":"works.is_active","type":"checkbox","input":true,"defaultValue":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":true,"labelPosition":"right","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"checkbox","value":"","name":"","id":"epgwc56"},{"label":"Completed","tableView":false,"key":"works.is_completed","type":"checkbox","input":true,"defaultValue":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":true,"labelPosition":"right","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"checkbox","value":"","name":"","id":"evzwr8q"},{"label":"Tabs","components":[{"label":"Phases","key":"phases","components":[{"label":"PhaseGrid","labelPosition":"top","labelWidth":"","labelMargin":"","description":"","tooltip":"","customClass":"","tabindex":"","openWhenEmpty":false,"disableAddingRemovingRows":true,"conditionalAddButton":"","hidden":false,"hideLabel":true,"autofocus":false,"disabled":false,"tableView":true,"modalEdit":false,"templates":{"header":"<div class=\"row\">\n      {% util.eachComponent(components, function(component) { %}\n        {% if (displayValue(component)) { %}\n          <div class=\"col-sm-2\">{{ t(component.label) }}</div>\n        {% } %}\n        \n      {% }) %}\n    </div>","tableHeader":"\n      <tr>\n        {% util.eachComponent(components, function(component) { %}\n          {% if (!component.hasOwnProperty('tableView') || component.tableView) { %}\n            <td class=\"editgrid-table-column\">{{ component.label }}</td>\n          {% } %}\n        {% }) %}\n        {% if (!instance.options.readOnly && !instance.disabled) { %}\n          <td class=\"editgrid-table-column\">Actions</td>\n        {% } %}\n      </tr>\n    ","row":"<div class=\"row\">\r\n\r\n      {% util.eachComponent(components, function(component) { %}\r\n        {% if (displayValue(component)) { %}\r\n          <div class=\"col-sm-2\">\r\n            {{ isVisibleInRow(component) ? getView(component, row[component.key]) : ''}}\r\n          </div>\r\n        {% } %}\r\n      {% }) %}\r\n\t  \r\n      {% if (false!==false) { %}\r\n        <div class=\"col-sm-2\">\r\n          <div class=\"btn-group pull-right\">\r\n            <button class=\"btn btn-default btn-light btn-sm editRow\"><i class=\"{{ iconClass('edit') }}\"></i></button>\r\n          </div>\r\n        </div>\r\n      {% } %}\r\n\t  \r\n    </div>","tableRow":"\n      {% util.eachComponent(components, function(component) { %}\n          {% if (!component.hasOwnProperty('tableView') || component.tableView) { %}\n            <td class=\"editgrid-table-column\">\n              {{ getView(component, row[component.key]) }}\n            </td>\n          {% } %}\n        {% }) %}\n        {% if (!instance.options.readOnly && !instance.disabled) { %}\n          <td class=\"editgrid-table-column\">\n            <div class=\"btn-group\">\n              <button class=\"btn btn-default btn-light btn-sm editRow\" aria-label=\"{{ t('Edit row') }}\"><i class=\"{{ iconClass('edit') }}\"></i></button>\n              {% if (!instance.hasRemoveButtons || instance.hasRemoveButtons()) { %}\n              <button class=\"btn btn-danger btn-sm removeRow\" aria-label=\"{{ t('Remove row') }}\"><i class=\"{{ iconClass('trash') }}\"></i></button>\n              {% } %}\n            </div>\n          </td>\n        {% } %}\n    ","footer":""},"rowClass":"","addAnother":"Add Phase","modal":false,"saveRow":"","removeRow":"Cancel","persistent":true,"inlineEdit":false,"protected":false,"dbIndex":false,"encrypted":false,"redrawOn":"eaactworktypestartdate","clearOnHide":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"allowCalculateOverride":false,"validateOn":"change","validate":{"required":false,"minLength":"","maxLength":"","customMessage":"","custom":"","customPrivate":false,"json":"","strictDateValidation":false,"multiple":false,"unique":false},"rowDrafts":false,"errorLabel":"","errors":"","key":"works-work_phases","tags":[],"properties":{},"conditional":{"show":null,"when":null,"eq":"","json":""},"customConditional":"","logic":[{"name":"PhaseGridChangeLogic","trigger":{"type":"event","event":"onPhaseGridChanged"},"actions":[{"name":"PhaseGridChangeAction","type":"customAction","customAction":"// this block has to be executed only if the below mentioned fields are set with proper values\r\nvar work_type_id = submission.data.works.work_type_id;\r\nvar ea_act_id = submission.data.works.ea_act_id;\r\nvar start_date = submission.data.works.start_date;\r\nvar hasValue = data.onload.hasValue;\r\nvar start_date_hidden = submission.data['start_date']\r\n// applicationId empty means the form is being submitted for the first time. Only then the api call has to be initiated to fill the table\r\nif(!hasValue(data.applicationId)\r\n  && hasValue(start_date_hidden)\r\n  && hasValue(work_type_id) \r\n  && hasValue(ea_act_id) \r\n  && hasValue(start_date)) {\r\ntry{\r\n  var phases = [];\r\n  var events = [];\r\n  var engagements = [];\r\n  var baseUrl = data.reportapiurl;\r\n  var headers = {headers: {\r\n  Authorization: 'Bearer '+localStorage.getItem('authToken')\r\n}\r\n}\r\n  fetch(baseUrl+\"phases/ea_acts/\"+ea_act_id+\"/work_types/\"+work_type_id,headers)\r\n  .then(response=>response.json())\r\n  .then(data=>{\r\n\t  if(data) {\r\n\t\t    data.forEach(function(phase,index){\r\n\t\t// \tif(phase.legislated === true && index===0){\r\n\t\t// \t\tstart_date = moment(start_date).add(1,'days').format('YYYY-MM-DD');\r\n\t\t// \t}\r\n\t\t\tvar edate = moment(start_date).add(phase.duration,'days');\r\n\t\t      phases.push({\r\n\t\t        phase_id: phase.id,\r\n\t\t        phasename: phase.name,\r\n\t\t\t\t    legislated: phase.legislated,\r\n\t\t        duration: phase.duration,\r\n\t\t        durationlabel: phase.duration,\r\n\t\t        start_date: start_date,\r\n\t\t        anticipated_end_date: edate\r\n\t\t      });\r\n\t\t\t  \r\n\t\t\t  var startMilestone = phase.milestones.filter(p=>p.is_start_event === true)[0];\r\n\t\t\t  var endMilestone = phase.milestones.filter(p=>p.is_end_event === true)[0];\r\n\t\t\t  \r\n\t\t\t  events.push({\r\n\t\t\t\t  title: phase.start_event,\r\n\t\t\t\t  phaselabel: phase.name,\r\n\t\t\t\t  eaactlabel: phase.ea_act.name,\r\n\t\t\t\t  milestonelabel: startMilestone.name,\r\n\t\t\t\t  anticipated_start_date: start_date,\r\n\t\t\t\t  anticipated_end_date: start_date,\r\n\t\t\t\t  milestone_id: startMilestone.id,\r\n\t\t\t\t  isfixedevent: true,\r\n\t\t\t\t  isendevent: false,\r\n\t\t\t\t  phaseindex: index,\r\n\t\t\t\t  duration: phase.duration,\r\n\t\t\t\t  rowindex: 1,\r\n\t\t\t\t  index: 1\r\n\t\t\t  });\r\n\t\t\t  events.push({\r\n\t\t\t\t  title: phase.end_event,\r\n\t\t\t\t  phaselabel: phase.name,\r\n\t\t\t\t  eaactlabel: phase.ea_act.name,\r\n\t\t\t\t  anticipated_start_date: edate,\r\n\t\t\t\t  milestonelabel: endMilestone.name,\r\n\t\t\t\t  anticipated_end_date: edate,\r\n\t\t\t\t  milestone_id: endMilestone.id,\r\n\t\t\t\t  isendevent: true,\r\n\t\t\t\t  isfixedevent: true,\r\n\t\t\t\t  phaseindex: index,\r\n\t\t\t\t  duration: phase.duration,\r\n\t\t\t\t  rowindex: 2,\r\n\t\t\t\t  index: 2\r\n\t\t\t  });\r\n\t\t\t  var engagement_start_date = moment(start_date).add(7,'days');\r\n\t\t\t  var engagement_end_date = moment(engagement_start_date).add(30,'days').format('YYYY-MM-DD');\r\n\t\t\t  engagements.push({\r\n\t\t\t\t  title: phase.name+' - PECP',\r\n\t\t\t\t  start_date: engagement_start_date.format('YYYY-MM-DD'),\r\n\t\t\t\t  end_date: engagement_end_date,\r\n\t\t\t\t  \"work_engagements\": {\r\n\t\t\t\t\t  phase_id: phase.id\r\n\t\t\t\t  }\r\n\t\t\t  });\r\n\t\t\t  daysToBeAdded = phase.duration;\r\n\t\t\t  start_date = moment(edate).add(1,'days').format('YYYY-MM-DD');\r\n\t\t    });\r\n\t\t    instance.setValue(phases);\r\n\t\t    var eventsGrid = utils.getComponent(instance.parent.components,'works-events');\r\n\t\t\tvar engagementsGrid = utils.getComponent(instance.parent.components,'engagements');\r\n\t\t\ttry{\r\n\t\t    var result;\r\n\t\tutils.findComponent(instance.root.components,'works.anticipated_decision_date',['works.anticipated_decision_date'],(components)=>result = components)\r\n\t\t    result.setValue(phases[phases.length-1].anticipated_end_date);\r\n\t\t\t}catch(e){console.error(e.message)};\r\n\t\t\t\r\n\t\t    eventsGrid.setValue(events);\r\n\t\t\tconsole.log('in phase event');\r\n\t\t\tengagementsGrid.setValue(engagements);\r\n\t\t    instance.emit('onEventsGridChanged',{});\r\n  }else{\r\n    value = [];\r\n  }});\r\n\r\n}catch(e){\r\n\tconsole.log('error',e.message);\r\n}\r\n}"}]}],"attributes":{},"overlay":{"style":"","page":"","left":"","top":"","width":"","height":""},"type":"editgrid","displayAsTable":false,"input":true,"components":[{"label":"Columns","columns":[{"components":[{"label":"Phase","tableView":true,"key":"phasename","type":"textfield","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":""},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"plain","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false,"id":"eb1ztl"},{"label":"workphase","key":"phase_id","type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"ehdhtr7"},{"label":"id","key":"id","type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"evp7cfg"},{"label":"Start Date","format":"yyyy-MM-dd","tableView":true,"enableMinDateInput":false,"datePicker":{"disableWeekends":false,"disableWeekdays":false,"showWeeks":true,"startingDay":0,"initDate":"","minMode":"day","maxMode":"year","yearRows":4,"yearColumns":5,"minDate":null,"maxDate":null},"enableMaxDateInput":false,"key":"start_date","type":"datetime","input":true,"widget":{"type":"calendar","displayInTimezone":"viewer","locale":"en","useLocaleSettings":false,"allowInput":true,"mode":"single","enableTime":true,"noCalendar":false,"format":"yyyy-MM-dd","hourIncrement":1,"minuteIncrement":1,"time_24hr":false,"minDate":null,"disableWeekends":false,"disableWeekdays":false,"maxDate":null},"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":"","protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"useLocaleSettings":false,"allowInput":true,"enableDate":true,"enableTime":true,"defaultDate":"","displayInTimezone":"viewer","timezone":"","datepickerMode":"day","timePicker":{"hourStep":1,"minuteStep":1,"showMeridian":true,"readonlyInput":false,"mousewheel":true,"arrowkeys":true},"customOptions":{},"id":"ed9khlp"}],"width":6,"offset":0,"push":0,"pull":0,"size":"md","currentWidth":6},{"components":[{"label":"Duration","tableView":true,"key":"durationlabel","type":"textfield","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":""},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"plain","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false,"id":"edhr8hj"},{"label":"duration","key":"duration","type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"ei3vyk"},{"label":"End Date","format":"yyyy-MM-dd","tableView":true,"enableMinDateInput":false,"datePicker":{"disableWeekends":false,"disableWeekdays":false,"showWeeks":true,"startingDay":0,"initDate":"","minMode":"day","maxMode":"year","yearRows":4,"yearColumns":5,"minDate":null,"maxDate":null},"enableMaxDateInput":false,"key":"anticipated_end_date","type":"datetime","input":true,"widget":{"type":"calendar","displayInTimezone":"viewer","locale":"en","useLocaleSettings":false,"allowInput":true,"mode":"single","enableTime":true,"noCalendar":false,"format":"yyyy-MM-dd","hourIncrement":1,"minuteIncrement":1,"time_24hr":false,"minDate":null,"disableWeekends":false,"disableWeekdays":false,"maxDate":null},"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":"","protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"useLocaleSettings":false,"allowInput":true,"enableDate":true,"enableTime":true,"defaultDate":"","displayInTimezone":"viewer","timezone":"","datepickerMode":"day","timePicker":{"hourStep":1,"minuteStep":1,"showMeridian":true,"readonlyInput":false,"mousewheel":true,"arrowkeys":true},"customOptions":{},"id":"epqh7fw"},{"label":"Legislated","tableView":true,"defaultValue":false,"key":"legislated","type":"checkbox","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":true,"labelPosition":"right","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"checkbox","value":"","name":"","id":"ewbk4g"}],"width":6,"offset":0,"push":0,"pull":0,"size":"md","currentWidth":6}],"key":"columns","type":"columns","input":false,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":false,"hidden":false,"clearOnHide":false,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"tree":false,"lazyLoad":false,"autoAdjust":false,"id":"eoyns9f"}],"placeholder":"","prefix":"","suffix":"","multiple":false,"defaultValue":null,"unique":false,"refreshOn":"","dataGridLabel":false,"widget":null,"showCharCount":false,"showWordCount":false,"allowMultipleMasks":false,"addons":[],"tree":true,"lazyLoad":false,"defaultOpen":false,"id":"ejqb8i"}]},{"label":"Events","key":"event","components":[{"label":"EventsGrid","conditionalAddButton":"show = Boolean(data.applicationId)","hideLabel":true,"tableView":false,"templates":{"row":"<div class=\"row\">\r\n\r\n      {% util.eachComponent(components, function(component) { %}\r\n\t\t{% if (parseInt(row['phaseindex'])>parseInt(submission.data.activephase) && component.attributes.type && component.attributes.type === 'select') { %}\r\n\t\t  {% (flattenedComponents[component.key]).parentDisabled=true; %}\r\n\t\t{% } else if(parseInt(row['phaseindex'])>parseInt(submission.data.activephase) || data.applicationId === \"\"){ %}\r\n\t\t\t{% (flattenedComponents[component.key]).disabled=true; %}\r\n\t\t{% } else { %}\r\n\t\t\t{% (flattenedComponents[component.key]).disabled=false; %}\r\n\t\t{% } %}\r\n        {% if (displayValue(component)) { %}\r\n          <div class=\"col-sm-2\">\r\n            {{ isVisibleInRow(component) ? getView(component, row[component.key]) : ''}}\r\n          </div>\r\n        {% } %}\r\n      {% }) %}\r\n\t  \r\n      {% if (!instance.options.readOnly && !instance.disabled) { %}\r\n        <div class=\"col-sm-2\">\r\n          <div class=\"btn-group pull-right\">\r\n            <button class=\"btn btn-default btn-light btn-sm editRow\"><i class=\"{{ iconClass('edit') }}\"></i></button>\r\n            {% if (row['isfixedevent']!=true) { %}\r\n              <button class=\"btn btn-danger btn-sm removeRow\"><i class=\"{{ iconClass('trash') }}\"></i></button>\r\n            {% } %}\r\n          </div>\r\n        </div>\r\n      {% } %}\r\n\t  \r\n    </div>","header":"<div class=\"row\">\n      {% util.eachComponent(components, function(component) { %}\n        {% if (displayValue(component)) { %}\n          <div class=\"col-sm-2\">{{ t(component.label) }}</div>\n        {% } %}\n      {% }) %}\n    </div>","tableHeader":"\n      <tr>\n        {% util.eachComponent(components, function(component) { %}\n          {% if (!component.hasOwnProperty('tableView') || component.tableView) { %}\n            <td class=\"editgrid-table-column\">{{ component.label }}</td>\n          {% } %}\n        {% }) %}\n        {% if (!instance.options.readOnly && !instance.disabled) { %}\n          <td class=\"editgrid-table-column\">Actions</td>\n        {% } %}\n      </tr>\n    ","tableRow":"\n      {% util.eachComponent(components, function(component) { %}\n          {% if (!component.hasOwnProperty('tableView') || component.tableView) { %}\n            <td class=\"editgrid-table-column\">\n              {{ getView(component, row[component.key]) }}\n            </td>\n          {% } %}\n        {% }) %}\n        {% if (!instance.options.readOnly && !instance.disabled) { %}\n          <td class=\"editgrid-table-column\">\n            <div class=\"btn-group\">\n              <button class=\"btn btn-default btn-light btn-sm editRow\" aria-label=\"{{ t('Edit row') }}\"><i class=\"{{ iconClass('edit') }}\"></i></button>\n              {% if (!instance.hasRemoveButtons || instance.hasRemoveButtons()) { %}\n              <button class=\"btn btn-danger btn-sm removeRow\" aria-label=\"{{ t('Remove row') }}\"><i class=\"{{ iconClass('trash') }}\"></i></button>\n              {% } %}\n            </div>\n          </td>\n        {% } %}\n    ","footer":""},"rowDrafts":false,"key":"works-events","logic":[{"name":"eventsGridSaveRowLogic","trigger":{"type":"event","event":"editGridSaveRow"},"actions":[{"name":"EventsGridSaveRowAction","type":"customAction","customAction":"try {\r\n    var events = submission.data['works-events'];\r\n    var phases = submission.data['works-work_phases'];\r\n    var phaseCount = phases.length;\r\n    // update the currentphase based on end_date being set or not\r\n    var currentphase = 0;\r\n    if (events.length > 0) {\r\n        var filteredEvents = events.filter(p => p.end_date != \"\" && p.isendevent === true && p.is_active === true);\r\n        if (filteredEvents.length > 0) {\r\n            var latestCompletedEvent = filteredEvents[filteredEvents.length - 1]\r\n            currentphase = parseInt(latestCompletedEvent.phaseindex) + 1;\r\n        }\r\n        submission.data.actionType = currentphase;\r\n        submission.data.works.current_phase_id = phases[currentphase].phase_id;\r\n    }\r\n    /*************************************************************************************************/\r\n    console.log('Events save');\r\n    // update the is_complete flag of event\r\n    // update the rowindex and phaseindex of newly added rows\r\n    events.forEach((event) => {\r\n        if (event.end_date !== \"\") event.is_complete = true;\r\n        else event.is_complete = false;\r\n        var eventsLength = events.filter(p=>p.phaseindex === data.activephase).length;\r\n        if(event.rowindex === \"\") event.rowindex = eventsLength;\r\n        if(event.phaseindex === \"\") event.phaseindex = data.activephase;\r\n        if(event.index === \"\") event.index = eventsLength + 1;\r\n    });\r\n    /**************************************************************************************************/\r\n    //sort the events with newly added ones\r\n    function sortEvents () {\r\n        events.sort((a, b) => {\r\n            var firstIndex = parseInt(a.phaseindex);\r\n            var secondIndex = parseInt(b.phaseindex);\r\n            if (firstIndex === secondIndex) {\r\n                return a.rowindex < b.rowindex ? -1 : 1;\r\n            } else {\r\n                return firstIndex < secondIndex ? -1 : 1;\r\n            }\r\n        });\r\n    }\r\n    sortEvents();\r\n    /*************************************************************************************************/\r\n    // gets the grid component instances\r\n    var eventsGrid = utils.getComponent(instance.parent.components, 'works-events');\r\n    var phaseGrid = utils.getComponent(instance.parent.components, 'works-work_phases');\r\n    // check to see if there are termination decisions have been chosen\r\n    var prevDiff = 0;\r\n    var outcomes = data.onload.outcomes;\r\n    for (var index = 0; index < events.length; index++) {\r\n        var event = events[index];\r\n        if (event.decision_id !== \"\" && event.is_active === true) {\r\n            var outcome = outcomes.filter(p => p.id === parseInt(event.decision_id));\r\n            if (outcome.length > 0 && outcome[0].terminates_work === true) {\r\n                if (confirm(\"Are you sure you want to terminate the work?\\n If you press 'Cancel', the event will be removed from the list.\")) {\r\n                    data.isworkterminated = true;\r\n                } else {\r\n                    data.isworkterminated = false;\r\n                    events.splice(index, 1);\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    var diff = 0;\r\n    var prevEvent;\r\n    var shouldPushDates = false;\r\n    events.forEach((event, index) => {\r\n        var phase = phases[event.phaseindex];\r\n        if (data.isworkterminated === false && event.end_date !== \"\") {\r\n            var eventState = data.eventstate;\r\n            // date calculation\r\n            var phaseEndDate = moment(phase.anticipated_end_date);\r\n            var eventEndDate = moment(event.end_date);\r\n            diff = eventEndDate.diff(phaseEndDate, 'days');\r\n            var shouldConfirm = false;\r\n            var haveAlreadyProcessed = eventState.filter(p => p.phaseindex == event.phaseindex \r\n                                                                && p.enddate === event.end_date\r\n                                                                && p.index === event.index)\r\n                                                .length > 0;\r\n            if (!haveAlreadyProcessed) {\r\n                if (diff > 0) {\r\n                    if (confirm(\"Actual End Date (\" + eventEndDate.format('YYYY-MM-DD') + \") falls outside the start/end dates of the selected phase(\" + moment(phase.start_date).format('YYYY-MM-DD') + \" to \" + moment(phase.anticipated_end_date).format('YYYY-MM-DD') + \"). Do you want to continue?\")) {\r\n                        shouldConfirm = true;\r\n                    } else {\r\n                        event.end_date = \"\";\r\n                    }\r\n                }\r\n                if ((diff > 0 && shouldConfirm === true) || diff <= 0) {\r\n                    shouldPushDates = true;\r\n                    eventState.push({\r\n                        phaseindex: event.phaseindex,\r\n                        enddate: moment(event.end_date).utcOffset(0,true).format('YYYY-MM-DD'),\r\n                        index: event.rowindex\r\n                    });\r\n                    if (prevDiff !== 0) event.end_date = moment(event.end_date).add(prevDiff, 'days').format('YYYY-MM-DD');\r\n                    if (diff != 0) {\r\n                        prevDiff = diff;\r\n                        var prevEndDate;\r\n                        phases.forEach((p, pindex) => {\r\n                            if (pindex >= event.phaseindex) {\r\n                                var oldStartDate = p.start_date;\r\n                                if (pindex > event.phaseindex) {\r\n                                    p.start_date = moment(prevEndDate).add(1, 'days').format('YYYY-MM-DD');\r\n                                }\r\n                                p.anticipated_end_date = moment(p.anticipated_end_date).add(diff, 'days').format('YYYY-MM-DD');\r\n                                prevEndDate = p.anticipated_end_date;\r\n\r\n                                if (pindex === event.phaseindex) {\r\n                                    var delta = (moment(p.anticipated_end_date).diff(moment(oldStartDate), 'days')) - p.duration;\r\n                                    if (p.legislated) {\r\n                                        if (delta !== 0) {\r\n                                            p.durationlabel = p.duration + '(' + (delta < 0 ? '-' : '+') + Math.abs(delta) + ')';\r\n                                        } else {\r\n                                            p.durationlabel = p.duration === 0?\"0\":p.duration;\r\n                                        }\r\n                                    } else {\r\n                                        p.durationlabel = (p.duration + delta)===0?\"0\": (p.duration + delta);\r\n                                    }\r\n                                }\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (event.phaseindex === data.activephase && event.isendevent === true) {\r\n            event.rowindex = events.filter(p => p.phaseindex === event.phaseindex).length;\r\n        }\r\n        if(shouldPushDates) {\r\n            if (prevEvent && event.phaseindex === prevEvent.phaseindex && event.rowindex > prevEvent.rowindex) {\r\n                event.anticipated_start_date = moment(event.anticipated_start_date).add(diff, 'days').format('YYYY-MM-DD');\r\n                event.anticipated_end_date = moment(event.anticipated_end_date).add(diff, 'days').format('YYYY-MM-DD');\r\n            }\r\n            if (prevEvent && event.phaseindex !== prevEvent.phaseindex) {\r\n                event.anticipated_start_date = moment(event.anticipated_start_date).add((diff), 'days').format('YYYY-MM-DD');\r\n                event.anticipated_end_date = moment(event.anticipated_end_date).add((diff), 'days').format('YYYY-MM-DD');\r\n            }\r\n            prevEvent = event;\r\n        }\r\n    });\r\n    // sets the anticipated end date as the last phase's end date\r\n    var anticipatedEndDate;\r\n    try {\r\n        utils.findComponent(instance.root.components, 'works.anticipated_decision_date', ['works.anticipated_decision_date']\r\n            , (components) => {\r\n                anticipatedEndDate = components;\r\n            })\r\n    } catch (e) {\r\n        console.warn('Error occured while searching for anticipatedenddate', e.message);\r\n    }\r\n    anticipatedEndDate.setValue(phases[phases.length - 1].anticipated_end_date);\r\n    sortEvents();\r\n    eventsGrid.resetValue();\r\n    setTimeout(function () {\r\n        eventsGrid.setValue(events);\r\n        phaseGrid.setValue(phases);\r\n    }, 100);\r\n\r\n} catch (e) {\r\n    console.error(e.message);\r\n}"}]},{"name":"editGridDeleteRowLogic","trigger":{"type":"event","event":"editGridDeleteRow"},"actions":[{"name":"editGridDeleteRowAction","type":"customAction","customAction":"var events = submission.data['works-events'];\nvar outcomes = data.onload.outcomes;\nconsole.log('terminated');\n\tfor(var index = 0; index < events.length; index++) {\n\t\tvar event = events[index];\n\t\t\tvar outcome = outcomes.filter(p=>p.id === parseInt(event.decision_id===\"\"?0:event.decision_id));\n\t\t\tif(outcome.length === 0){\n\t\t\t  data.isworkterminated = false;\n\t\t\t}\n\t\t}"}]}],"type":"editgrid","displayAsTable":false,"input":true,"components":[{"label":"Event Title","tableView":true,"validate":{"required":true,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":""},"key":"title","type":"textfield","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"plain","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false,"id":"ebgzqtr"},{"label":"Short Description","autoExpand":false,"tableView":false,"key":"short_description","type":"textarea","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":"","minWords":"","maxWords":""},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"html","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false,"rows":3,"wysiwyg":false,"editor":"","fixedSize":true,"id":"eip7loa"},{"label":"fixedEvent","defaultValue":"false","key":"isfixedevent","type":"hidden","input":true,"tableView":false,"disabled":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"ej7v6vv"},{"label":"duration","key":"duration","type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"eji9ja"},{"label":"endEvent","customDefaultValue":"value = false;","key":"isendevent","type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"ew7sib"},{"label":"rowIndex","customDefaultValue":"// var interval = setInterval(function(){\r\n//   var events = submission.data['works-events'];\r\n//   if(events.length>0) {\r\n//     var currentPhaseIndex = submission.data.activephase;\r\n//     var currentPhaseEvents = events.filter(p=>p.phaseindex==currentPhaseIndex);\r\n//     instance.setValue(currentPhaseEvents.length-1);\r\n//     clearInterval(interval);\r\n//   }\r\n// },100);\r\n","key":"rowindex","type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"elw4vt"},{"label":"id","key":"id","type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"eavlh5t"},{"label":"index","calculateValue":"if(value !== \"\" && value !== null) {\n  value = parseInt(value);\n}","key":"index","type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"em2604m"},{"label":"phaseIndex","defaultValue":"0","customDefaultValue":"// var interval = setInterval(function(){\n// var phases = data['works-work_phases'];\n// if(phases.length > 0) {instance.setValue(data.activephase);\n// clearInterval(interval);\n \n// }\n// },100);","calculateValue":"if(value !== \"\" && value !==null) {\n  value = parseInt(value);\n}","key":"phaseindex","type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"ef0w8e"},{"label":"Long Description","rows":6,"autoExpand":false,"tableView":false,"key":"long_description","type":"textarea","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":"","minWords":"","maxWords":""},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"html","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false,"wysiwyg":false,"editor":"","fixedSize":true,"id":"eti86nq"},{"label":"OH Attendance","tableView":false,"key":"oh_attendance","type":"textfield","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":""},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"plain","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false,"id":"ekdfffr"},{"label":"Columns","columns":[{"components":[{"label":"Phase","disabled":true,"tableView":true,"clearOnHide":false,"customDefaultValue":"\r\n\r\nvar interval = setInterval(function(){\r\n  var events = submission.data['works-events'];\r\n  if(events.length>0) {\r\n    var currentPhaseIndex = submission.data.activephase;\r\n    var currentPhase = events.filter(p=>p.phaseindex==currentPhaseIndex)[0];\r\n    if(currentPhase) {\r\n     instance.setValue(currentPhase.phaselabel); \r\n    }\r\n    clearInterval(interval);\r\n  }\r\n},100);\r\n","key":"phaselabel","type":"textfield","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","autofocus":false,"dbIndex":false,"calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":""},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"plain","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false,"id":"eppokmj"},{"label":"Anticipated Start Date","format":"yyyy-MM-dd","tableView":true,"enableMinDateInput":false,"datePicker":{"disableWeekends":false,"disableWeekdays":false,"showWeeks":true,"startingDay":0,"initDate":"","minMode":"day","maxMode":"year","yearRows":4,"yearColumns":5,"minDate":null,"maxDate":null},"enableMaxDateInput":false,"enableTime":false,"customDefaultValue":"var interval = setInterval(function(){\r\n  var phases = submission.data['works-work_phases'];\r\n  if(phases && phases.length>0) {\r\n    var currentPhaseIndex = submission.data.activephase;\r\n    var currentPhase = phases[currentPhaseIndex];\r\n    if(currentPhase) {\r\n        instance.setValue(currentPhase.start_date);    \r\n    }\r\n  \r\n    clearInterval(interval);\r\n  }\r\n},100);\r\n","validate":{"required":true,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"key":"anticipated_start_date","type":"datetime","input":true,"widget":{"type":"calendar","displayInTimezone":"viewer","locale":"en","useLocaleSettings":false,"allowInput":true,"mode":"single","enableTime":false,"noCalendar":false,"format":"yyyy-MM-dd","hourIncrement":1,"minuteIncrement":1,"time_24hr":false,"minDate":null,"disableWeekends":false,"disableWeekdays":false,"maxDate":null},"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":"","protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"useLocaleSettings":false,"allowInput":true,"enableDate":true,"defaultDate":"","displayInTimezone":"viewer","timezone":"","datepickerMode":"day","timePicker":{"hourStep":1,"minuteStep":1,"showMeridian":true,"readonlyInput":false,"mousewheel":true,"arrowkeys":true},"customOptions":{},"id":"eint1vr"}],"width":3,"offset":0,"push":0,"pull":0,"size":"md","currentWidth":3},{"components":[{"label":"Milestone","disabled":true,"tableView":false,"key":"milestonelabel","customConditional":"// make the milestonelabel invisible if \n// the event rows are added adhoc\nif(row['isfixedevent']!=true) {\n instance.visible= false; \n}","logic":[{"name":"eventGridsRowChangeLogic","trigger":{"type":"event","event":"change"},"actions":[{"name":"eventsGridRowChangeAction","type":"customAction","customAction":"if(row['milestone']['value']) {\n  instance.setValue(row['milestone']['label']);\n}"}]}],"type":"textfield","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":""},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"plain","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false,"id":"epm75q"},{"label":"Milestone","widget":"choicesjs","tableView":false,"dataSrc":"custom","data":{"custom":"try {\r\n    var milestones = [];\r\n    var phases = submission.data['works-work_phases'];\r\n    if (phases && phases.length > 0) {\r\n        var currentPhase = phases[data.activephase];\r\n        fetch(data.reportapiurl + 'milestones/phases/' + currentPhase.phase_id)\r\n            .then(response => response.json())\r\n            .then(data => {\r\n\r\n                milestones = data.map(p => {\r\n                    return {\r\n                        value: p.id,\r\n                        label: p.name\r\n                    }\r\n                });\r\n                values = milestones;\r\n                instance.setItems(milestones);\r\n\r\n            })\r\n    }\r\n\r\n} catch (e) {\r\n    console.log(e.message);\r\n}","values":[{"label":"","value":""}],"json":"","url":"","resource":""},"idPath":"","persistent":false,"clearOnHide":false,"validate":{"custom":"try {\n  if(row['isfixedevent']===true) {\n    valid = true;\n  }else{\n    valid = row['milestone_id']!==\"\"?true: 'Please select milestone';\n  }\n}catch(e) {\n  console.log('Error from milestone: works-events',e.message);\n}\n","required":false,"customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"onlyAvailableItems":false},"key":"milestone","conditional":{"show":true,"when":null,"eq":""},"customConditional":"\n\n  // make the milestone dropdown invisible if \n// the event rows are prepopulated\nif(row.isfixedevent === true) {\n  show = false;\n}\n","type":"select","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"hidden":false,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"clearOnRefresh":false,"limit":100,"valueProperty":"","lazyLoad":true,"filter":"","searchEnabled":true,"searchDebounce":0.3,"searchField":"","minSearch":0,"readOnlyValue":false,"authenticate":false,"ignoreCache":false,"template":"<span>{{ item.label }}</span>","selectFields":"","selectThreshold":0.3,"uniqueOptions":false,"fuseOptions":{"include":"score","threshold":0.3},"indexeddb":{"filter":{}},"customOptions":{},"useExactSearch":false,"id":"eqhn7r6"},{"label":"milestoneId","key":"milestone_id","logic":[{"name":"eventsGridRowChangeLogic","trigger":{"type":"event","event":"change"},"actions":[{"name":"eventsGridRowChangeAction","type":"customAction","customAction":"if(row['milestone']['value']) {\n  instance.setValue(row['milestone']['value']);\n}"}]}],"type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"etanyy"},{"label":"Anticipated End Date","format":"yyyy-MM-dd","tableView":true,"enableMinDateInput":false,"datePicker":{"disableWeekends":false,"disableWeekdays":false,"showWeeks":true,"startingDay":0,"initDate":"","minMode":"day","maxMode":"year","yearRows":4,"yearColumns":5,"minDate":null,"maxDate":null},"enableMaxDateInput":false,"enableTime":false,"customDefaultValue":"var interval = setInterval(function(){\r\n  var phases = submission.data['works-work_phases'];\r\n  if(phases && phases.length>0) {\r\n    var currentPhaseIndex = submission.data.activephase;\r\n    var currentPhase = phases[currentPhaseIndex];\r\n    if(currentPhase) {\r\n     instance.setValue(currentPhase.anticipated_end_date); \r\n    }\r\n    clearInterval(interval);\r\n  }\r\n},100);\r\n","validate":{"custom":"try{\n  var aniticipatedEndDate = row['anticipated_end_date'];\n  var startDate = row['anticipated_start_date'];\n  if(startDate.length === 0) {\n    valid = \"Please choose Start Date\";\n  }else if(startDate.length > 0 && aniticipatedEndDate.length > 0){\n    var start_date = moment(startDate);\n    var thisdate = moment(aniticipatedEndDate);\n    var diff = thisdate.diff(start_date,'days');\n    valid = diff>=0?true:'Anticipated end date should be higher than Start Date';\n  }else if(aniticipatedEndDate.length === 0) {\n    valid = 'Please select Anticipated Decision Date';\n  }\n}catch(e) {\n  console.log('Error from anticipated decision date: works', e.message);\n}","required":false,"customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"key":"anticipated_end_date","type":"datetime","input":true,"widget":{"type":"calendar","displayInTimezone":"viewer","locale":"en","useLocaleSettings":false,"allowInput":true,"mode":"single","enableTime":false,"noCalendar":false,"format":"yyyy-MM-dd","hourIncrement":1,"minuteIncrement":1,"time_24hr":false,"minDate":null,"disableWeekends":false,"disableWeekdays":false,"maxDate":null},"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":"","protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"useLocaleSettings":false,"allowInput":true,"enableDate":true,"defaultDate":"","displayInTimezone":"viewer","timezone":"","datepickerMode":"day","timePicker":{"hourStep":1,"minuteStep":1,"showMeridian":true,"readonlyInput":false,"mousewheel":true,"arrowkeys":true},"customOptions":{},"id":"e5x1as"}],"width":3,"offset":0,"push":0,"pull":0,"size":"md","currentWidth":3},{"components":[{"label":"Decision","widget":"choicesjs","tableView":false,"dataSrc":"custom","data":{"custom":"try {\r\n  if(row['milestone_id']){\r\n    var outcomes = [];\r\n        fetch(data.reportapiurl + 'outcomes/milestones/' + row['milestone_id'])\r\n            .then(response => response.json())\r\n            .then(data => {\r\n\r\n                outcomes = data.map(p => {\r\n                    return {\r\n                        value: p.id,\r\n                        label: p.name\r\n                    }\r\n                });\r\n                values = outcomes;\r\n                instance.setItems(outcomes);\r\n\r\n            }) \r\n  }\r\n} catch (e) {\r\n    console.log(e.message);\r\n}","values":[{"label":"","value":""}],"json":"","url":"","resource":""},"refreshOn":"works-events.milestone","customDefaultValue":"value='';","key":"decision","attributes":{"type":"select"},"type":"select","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"calculateValue":"","calculateServer":false,"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"onlyAvailableItems":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"idPath":"id","clearOnRefresh":false,"limit":100,"valueProperty":"","lazyLoad":true,"filter":"","searchEnabled":true,"searchDebounce":0.3,"searchField":"","minSearch":0,"readOnlyValue":false,"authenticate":false,"ignoreCache":false,"template":"<span>{{ item.label }}</span>","selectFields":"","selectThreshold":0.3,"uniqueOptions":false,"fuseOptions":{"include":"score","threshold":0.3},"indexeddb":{"filter":{}},"customOptions":{},"useExactSearch":false,"id":"epak7v"},{"label":"decisionId","key":"decision_id","logic":[{"name":"eventsGridRowChangeLogic","trigger":{"type":"event","event":"change"},"actions":[{"name":"eventsGridRowChangeAction","type":"customAction","customAction":"\nif(row['decision']['value']) {\n  instance.setValue(row['decision']['value']);\n}else {\n  instance.setValue('');\n}"}]}],"type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"ei9p7qg"},{"label":"Actual Start Date","format":"yyyy-MM-dd","tableView":false,"enableMinDateInput":false,"datePicker":{"disableWeekends":false,"disableWeekdays":false,"showWeeks":true,"startingDay":0,"initDate":"","minMode":"day","maxMode":"year","yearRows":4,"yearColumns":5,"minDate":null,"maxDate":null},"enableMaxDateInput":false,"enableTime":false,"validate":{"custom":"try{\n  var anticipatedStartDate = row['anticipated_start_date'];\n  var actual_start_date = row['start_date'];\n  var endDate = row['end_date'];\n  if(actual_start_date.length > 0 && anticipatedStartDate.length > 0){\n    var start_date = moment(anticipatedStartDate);\n    var thisdate = moment(actual_start_date);\n    var diff = thisdate.diff(start_date,'days');\n    valid = diff>=0?true:'Actual start date should be higher than anticipated start sate';\n  }else if(endDate.length > 0 && anticipatedStartDate.length === 0) {\n    valid = 'Please select start date';\n  }\n}catch(e) {\n  console.log('Error from anticipated start date: events', e.message);\n}","required":false,"customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"key":"start_date","type":"datetime","input":true,"widget":{"type":"calendar","displayInTimezone":"viewer","locale":"en","useLocaleSettings":false,"allowInput":true,"mode":"single","enableTime":false,"noCalendar":false,"format":"yyyy-MM-dd","hourIncrement":1,"minuteIncrement":1,"time_24hr":false,"minDate":null,"disableWeekends":false,"disableWeekdays":false,"maxDate":null},"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":"","protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"useLocaleSettings":false,"allowInput":true,"enableDate":true,"defaultDate":"","displayInTimezone":"viewer","timezone":"","datepickerMode":"day","timePicker":{"hourStep":1,"minuteStep":1,"showMeridian":true,"readonlyInput":false,"mousewheel":true,"arrowkeys":true},"customOptions":{},"id":"ehhrnbn"}],"size":"md","width":3,"offset":0,"push":0,"pull":0,"currentWidth":3},{"components":[{"label":"EA Act","disabled":true,"tableView":false,"customDefaultValue":"\r\n\r\nvar interval = setInterval(function(){\r\n  var events = submission.data['works-events'];\r\n  if(events.length>0) {\r\n    var currentPhaseIndex = submission.data.activephase;\r\n    var currentPhase = events.filter(p=>p.phaseindex==currentPhaseIndex)[0];\r\n    clearInterval(interval);\r\n    instance.setValue(currentPhase.eaactlabel);\r\n    \r\n  }\r\n},100);\r\n","key":"eaactlabel","type":"textfield","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","autofocus":false,"dbIndex":false,"calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":""},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"plain","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false,"id":"euho8cd"},{"label":"Actual End Date","displayInTimezone":"submission","format":"yyyy-MM-dd","tableView":true,"enableMinDateInput":false,"datePicker":{"disableWeekends":false,"disableWeekdays":false,"showWeeks":true,"startingDay":0,"initDate":"","minMode":"day","maxMode":"year","yearRows":4,"yearColumns":5,"minDate":null,"maxDate":null},"enableMaxDateInput":false,"enableTime":false,"timePicker":{"showMeridian":false,"hourStep":1,"minuteStep":1,"readonlyInput":false,"mousewheel":true,"arrowkeys":true},"validate":{"custom":"try{\n  var endDate = row['end_date'];\n  var startDate = row['start_date'];\n  if(startDate.length > 0 && endDate.length > 0){\n    var start_date = moment(startDate);\n    var thisdate = moment(endDate);\n    var diff = thisdate.diff(start_date,'days');\n    valid = diff>=0?true:'End date should be higher than start date';\n  }else  {\n    valid = true;\n  }\n}catch(e) {\n  console.log('Error from anticipated decision date: works', e.message);\n}","required":false,"customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"key":"end_date","type":"datetime","input":true,"widget":{"type":"calendar","displayInTimezone":"submission","locale":"en","useLocaleSettings":false,"allowInput":true,"mode":"single","enableTime":false,"noCalendar":false,"format":"yyyy-MM-dd","hourIncrement":1,"minuteIncrement":1,"time_24hr":true,"minDate":null,"disableWeekends":false,"disableWeekdays":false,"maxDate":null},"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":"","protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"useLocaleSettings":false,"allowInput":true,"enableDate":true,"defaultDate":"","timezone":"","datepickerMode":"day","customOptions":{},"id":"e2pwqwr"}],"size":"md","width":3,"offset":0,"push":0,"pull":0,"currentWidth":3}],"key":"columns","type":"columns","input":false,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":false,"hidden":false,"clearOnHide":false,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"tree":false,"lazyLoad":false,"autoAdjust":false,"id":"egq95mg"},{"label":"Active","tableView":false,"defaultValue":false,"key":"is_active","type":"checkbox","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":true,"labelPosition":"right","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"checkbox","value":"","name":"","id":"epk8opn"},{"label":"isComplete","key":"is_complete","type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"ez6mafq"}],"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"tree":true,"lazyLoad":false,"disableAddingRemovingRows":false,"removeRow":"Cancel","defaultOpen":false,"openWhenEmpty":false,"modal":false,"inlineEdit":false,"id":"euq05en"}]},{"label":"Engagements","key":"engagementstab","components":[{"label":"Engagements","disableAddingRemovingRows":true,"reorder":false,"layoutFixed":false,"enableRowGroups":false,"initEmpty":false,"tableView":false,"defaultValue":[{"title":"","start_date":"","end_date":""}],"key":"engagements","type":"datagrid","input":true,"components":[{"label":"Title","disabled":true,"tableView":true,"key":"title","type":"textfield","input":true,"id":"ewrus4i0000000000000000000000000000000000000000000000000000000000000000000000000","placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":""},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"plain","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false},{"label":"Start Date","disabled":true,"tableView":false,"enableMinDateInput":false,"datePicker":{"disableWeekends":false,"disableWeekdays":false,"showWeeks":true,"startingDay":0,"initDate":"","minMode":"day","maxMode":"year","yearRows":4,"yearColumns":5,"minDate":null,"maxDate":null},"enableMaxDateInput":false,"key":"start_date","type":"datetime","input":true,"widget":{"type":"calendar","displayInTimezone":"viewer","locale":"en","useLocaleSettings":false,"allowInput":true,"mode":"single","enableTime":true,"noCalendar":false,"format":"yyyy-MM-dd hh:mm a","hourIncrement":1,"minuteIncrement":1,"time_24hr":false,"minDate":null,"disableWeekends":false,"disableWeekdays":false,"maxDate":null},"id":"enn0s2e0000000000000000000000000000000000000000000000000000000000000000000000000","placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":"","protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"format":"yyyy-MM-dd hh:mm a","useLocaleSettings":false,"allowInput":true,"enableDate":true,"enableTime":true,"defaultDate":"","displayInTimezone":"viewer","timezone":"","datepickerMode":"day","timePicker":{"hourStep":1,"minuteStep":1,"showMeridian":true,"readonlyInput":false,"mousewheel":true,"arrowkeys":true},"customOptions":{}},{"label":"End Date","disabled":true,"tableView":false,"enableMinDateInput":false,"datePicker":{"disableWeekends":false,"disableWeekdays":false,"showWeeks":true,"startingDay":0,"initDate":"","minMode":"day","maxMode":"year","yearRows":4,"yearColumns":5,"minDate":null,"maxDate":null},"enableMaxDateInput":false,"key":"end_date","type":"datetime","input":true,"widget":{"type":"calendar","displayInTimezone":"viewer","locale":"en","useLocaleSettings":false,"allowInput":true,"mode":"single","enableTime":true,"noCalendar":false,"format":"yyyy-MM-dd hh:mm a","hourIncrement":1,"minuteIncrement":1,"time_24hr":false,"minDate":null,"disableWeekends":false,"disableWeekdays":false,"maxDate":null},"id":"ed6d6yn0000000000000000000000000000000000000000000000000000000000000000000000000","placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":"","protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"format":"yyyy-MM-dd hh:mm a","useLocaleSettings":false,"allowInput":true,"enableDate":true,"enableTime":true,"defaultDate":"","displayInTimezone":"viewer","timezone":"","datepickerMode":"day","timePicker":{"hourStep":1,"minuteStep":1,"showMeridian":true,"readonlyInput":false,"mousewheel":true,"arrowkeys":true},"customOptions":{}},{"label":"id","key":"id","type":"hidden","input":true,"tableView":false,"id":"elwy82b0000000000000000000000000000000000000000000000000000000000000000000000000","placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden"},{"label":"work_enagements_id","labelWidth":"","labelMargin":"","customClass":"","dataGridLabel":false,"modalEdit":false,"defaultValue":null,"persistent":true,"protected":false,"dbIndex":false,"encrypted":false,"redrawOn":"","customDefaultValue":"","calculateValue":"","calculateServer":false,"key":"work_engagements.id","tags":[],"properties":{},"logic":[],"attributes":{},"overlay":{"style":"","page":"","left":"","top":"","width":"","height":""},"type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","suffix":"","multiple":false,"unique":false,"hidden":false,"clearOnHide":true,"refreshOn":"","labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"widget":{"type":"input"},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"allowCalculateOverride":false,"showCharCount":false,"showWordCount":false,"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"eek0bhr00000000000000000"},{"label":"projectId","labelWidth":"","labelMargin":"","customClass":"","dataGridLabel":false,"modalEdit":false,"defaultValue":null,"persistent":true,"protected":false,"dbIndex":false,"encrypted":false,"redrawOn":"","customDefaultValue":"","calculateValue":"value = submission.data.works.project_id;","calculateServer":false,"key":"work_engagements.project_id","tags":[],"properties":{},"logic":[],"attributes":{},"overlay":{"style":"","page":"","left":"","top":"","width":"","height":""},"type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","suffix":"","multiple":false,"unique":false,"hidden":false,"clearOnHide":true,"refreshOn":"","labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"widget":{"type":"input"},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"allowCalculateOverride":false,"showCharCount":false,"showWordCount":false,"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"eguwx2m0000000000000000"},{"label":"workTypeId","labelWidth":"","labelMargin":"","customClass":"","dataGridLabel":false,"modalEdit":false,"defaultValue":null,"persistent":true,"protected":false,"dbIndex":false,"encrypted":false,"redrawOn":"","customDefaultValue":"","calculateValue":"value = submission.data.works.work_type_id;","calculateServer":false,"key":"work_engagements.work_type_id","tags":[],"properties":{},"logic":[],"attributes":{},"overlay":{"style":"","page":"","left":"","top":"","width":"","height":""},"type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","suffix":"","multiple":false,"unique":false,"hidden":false,"clearOnHide":true,"refreshOn":"","labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"widget":{"type":"input"},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"allowCalculateOverride":false,"showCharCount":false,"showWordCount":false,"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"ew97wgs000000000000000"},{"label":"engagementId","labelWidth":"","labelMargin":"","customClass":"","dataGridLabel":false,"modalEdit":false,"defaultValue":null,"persistent":true,"protected":false,"dbIndex":false,"encrypted":false,"redrawOn":"","customDefaultValue":"","calculateValue":"","calculateServer":false,"key":"work_engagements.engagement_id","tags":[],"properties":{},"logic":[],"attributes":{},"overlay":{"style":"","page":"","left":"","top":"","width":"","height":""},"type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","suffix":"","multiple":false,"unique":false,"hidden":false,"clearOnHide":true,"refreshOn":"","labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"widget":{"type":"input"},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"allowCalculateOverride":false,"showCharCount":false,"showWordCount":false,"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"e7cywv00000000000000"},{"label":"phaseId","labelWidth":"","labelMargin":"","customClass":"","dataGridLabel":false,"modalEdit":false,"defaultValue":null,"persistent":true,"protected":false,"dbIndex":false,"encrypted":false,"redrawOn":"","customDefaultValue":"","calculateValue":"","calculateServer":false,"key":"work_engagements.phase_id","tags":[],"properties":{},"logic":[],"attributes":{},"overlay":{"style":"","page":"","left":"","top":"","width":"","height":""},"type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","suffix":"","multiple":false,"unique":false,"hidden":false,"clearOnHide":true,"refreshOn":"","labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"widget":{"type":"input"},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"allowCalculateOverride":false,"showCharCount":false,"showWordCount":false,"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"e5z1vi0000000000000"},{"label":"Select","labelPosition":"top","widget":"choicesjs","labelWidth":"","labelMargin":"","placeholder":"","description":"","tooltip":"","customClass":"","tabindex":"","hidden":false,"hideLabel":false,"uniqueOptions":false,"autofocus":false,"dataGridLabel":false,"disabled":false,"tableView":true,"modalEdit":false,"multiple":false,"dataSrc":"custom","data":{"values":[{"label":"","value":""}],"resource":"","json":"","url":"","custom":"var staffs = (submission.data['works-staff_work_roles']).map(p=>{\n  var selected_staff = data.onload.staffs.filter(q=>q.id == p.staff_id)[0];\n  return {\n    label: selected_staff.name,\n    value: selected_staff.id\n  }\n});\nconsole.log('VALUES',staffs);\nvalues = staffs;\n"},"dataType":"","idPath":"id","valueProperty":"value","limit":100,"template":"<span>{{ item.label }}</span>","refreshOn":"","refreshOnBlur":"","clearOnRefresh":false,"searchEnabled":true,"selectThreshold":0.3,"readOnlyValue":false,"customOptions":{},"useExactSearch":false,"persistent":true,"protected":false,"dbIndex":false,"encrypted":false,"clearOnHide":true,"customDefaultValue":"","calculateValue":"","calculateServer":false,"allowCalculateOverride":false,"validateOn":"change","validate":{"required":false,"onlyAvailableItems":false,"customMessage":"","custom":"","customPrivate":false,"json":"","strictDateValidation":false,"multiple":false,"unique":false},"unique":false,"errorLabel":"","errors":"","key":"staff_id","tags":[],"properties":{},"conditional":{"show":null,"when":null,"eq":"","json":""},"customConditional":"","logic":[],"attributes":{},"overlay":{"style":"","page":"","left":"","top":"","width":"","height":""},"type":"select","indexeddb":{"filter":{}},"selectFields":"","searchField":"","searchDebounce":0.3,"minSearch":0,"filter":"","redrawOn":"","input":true,"prefix":"","suffix":"","showCharCount":false,"showWordCount":false,"allowMultipleMasks":false,"addons":[],"lazyLoad":true,"authenticate":false,"ignoreCache":false,"fuseOptions":{"include":"score","threshold":0.3},"id":"eyj86x200000000","defaultValue":""}],"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"tree":true,"lazyLoad":false,"id":"e9a711j"}]},{"label":"Issues","key":"issue","components":[{"label":"IssuesGrid","hideLabel":true,"tableView":false,"rowDrafts":false,"key":"works-issues","type":"editgrid","displayAsTable":false,"input":true,"components":[{"label":"Title","tableView":true,"validate":{"required":true,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":""},"key":"title","type":"textfield","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"plain","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false,"id":"evmngj8"},{"label":"id","key":"id","type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"e81kmf"},{"label":"Short Description","autoExpand":false,"tableView":false,"validate":{"required":true,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":"","minWords":"","maxWords":""},"key":"short_description","type":"textarea","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"html","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false,"rows":3,"wysiwyg":false,"editor":"","fixedSize":true,"id":"emwm9oi"},{"label":"Long Description","rows":6,"autoExpand":false,"tableView":false,"key":"long_description","type":"textarea","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":"","minWords":"","maxWords":""},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"html","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false,"wysiwyg":false,"editor":"","fixedSize":true,"id":"e0xxr3"},{"label":"Columns","columns":[{"components":[{"label":"Start Date","format":"yyyy-MM-dd","tableView":true,"enableMinDateInput":false,"datePicker":{"disableWeekends":false,"disableWeekdays":false,"showWeeks":true,"startingDay":0,"initDate":"","minMode":"day","maxMode":"year","yearRows":4,"yearColumns":5,"minDate":null,"maxDate":null},"enableMaxDateInput":false,"enableTime":false,"timePicker":{"showMeridian":false,"hourStep":1,"minuteStep":1,"readonlyInput":false,"mousewheel":true,"arrowkeys":true},"validate":{"required":true,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"key":"start_date","type":"datetime","input":true,"widget":{"type":"calendar","displayInTimezone":"viewer","locale":"en","useLocaleSettings":false,"allowInput":true,"mode":"single","enableTime":false,"noCalendar":false,"format":"yyyy-MM-dd","hourIncrement":1,"minuteIncrement":1,"time_24hr":true,"minDate":null,"disableWeekends":false,"disableWeekdays":false,"maxDate":null},"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":"","protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"useLocaleSettings":false,"allowInput":true,"enableDate":true,"defaultDate":"","displayInTimezone":"viewer","timezone":"","datepickerMode":"day","customOptions":{},"id":"ewu18tq"}],"size":"md","width":4,"offset":0,"push":0,"pull":0,"currentWidth":4},{"components":[{"label":"Anticipated Resolution Date","format":"yyyy-MM-dd","tableView":false,"enableMinDateInput":false,"datePicker":{"disableWeekends":false,"disableWeekdays":false,"showWeeks":true,"startingDay":0,"initDate":"","minMode":"day","maxMode":"year","yearRows":4,"yearColumns":5,"minDate":null,"maxDate":null},"enableMaxDateInput":false,"enableTime":false,"key":"anticipated_resolution_date","type":"datetime","input":true,"widget":{"type":"calendar","displayInTimezone":"viewer","locale":"en","useLocaleSettings":false,"allowInput":true,"mode":"single","enableTime":false,"noCalendar":false,"format":"yyyy-MM-dd","hourIncrement":1,"minuteIncrement":1,"time_24hr":false,"minDate":null,"disableWeekends":false,"disableWeekdays":false,"maxDate":null},"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":"","protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"useLocaleSettings":false,"allowInput":true,"enableDate":true,"defaultDate":"","displayInTimezone":"viewer","timezone":"","datepickerMode":"day","timePicker":{"hourStep":1,"minuteStep":1,"showMeridian":true,"readonlyInput":false,"mousewheel":true,"arrowkeys":true},"customOptions":{},"id":"es0l7j"}],"size":"md","width":4,"offset":0,"push":0,"pull":0,"currentWidth":4},{"components":[{"label":"Resolution Date","format":"yyyy-MM-dd","tableView":false,"enableMinDateInput":false,"datePicker":{"disableWeekends":false,"disableWeekdays":false,"showWeeks":true,"startingDay":0,"initDate":"","minMode":"day","maxMode":"year","yearRows":4,"yearColumns":5,"minDate":null,"maxDate":null},"enableMaxDateInput":false,"enableTime":false,"key":"resolution_date","type":"datetime","input":true,"widget":{"type":"calendar","displayInTimezone":"viewer","locale":"en","useLocaleSettings":false,"allowInput":true,"mode":"single","enableTime":false,"noCalendar":false,"format":"yyyy-MM-dd","hourIncrement":1,"minuteIncrement":1,"time_24hr":false,"minDate":null,"disableWeekends":false,"disableWeekdays":false,"maxDate":null},"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":"","protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"useLocaleSettings":false,"allowInput":true,"enableDate":true,"defaultDate":"","displayInTimezone":"viewer","timezone":"","datepickerMode":"day","timePicker":{"hourStep":1,"minuteStep":1,"showMeridian":true,"readonlyInput":false,"mousewheel":true,"arrowkeys":true},"customOptions":{},"id":"e06ikcb"}],"size":"md","width":4,"offset":0,"push":0,"pull":0,"currentWidth":4}],"key":"columns","type":"columns","input":false,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":false,"hidden":false,"clearOnHide":false,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"tree":false,"lazyLoad":false,"autoAdjust":false,"id":"ed07q9r"},{"label":"Columns","columns":[{"components":[{"label":"Key Issue","tableView":true,"defaultValue":false,"key":"is_key_issue","type":"checkbox","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":true,"labelPosition":"right","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"checkbox","value":"","name":"","id":"ef93i08"}],"width":3,"offset":0,"push":0,"pull":0,"size":"md","currentWidth":3},{"components":[{"label":"Sensitive","labelWidth":30,"tableView":false,"defaultValue":false,"key":"is_sensitive","type":"checkbox","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":true,"labelPosition":"right","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"checkbox","value":"","name":"","id":"e56pwbr"}],"width":3,"offset":0,"push":0,"pull":0,"size":"md","currentWidth":3},{"components":[{"label":"Active","tableView":true,"defaultValue":false,"key":"is_active","type":"checkbox","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":true,"labelPosition":"right","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"checkbox","value":"","name":"","id":"ezz642d"}],"size":"md","width":3,"offset":0,"push":0,"pull":0,"currentWidth":3},{"components":[{"label":"Resolved","tableView":true,"defaultValue":false,"key":"is_resolved","type":"checkbox","input":true,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":true,"labelPosition":"right","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"checkbox","value":"","name":"","id":"eh39wxe"}],"size":"md","width":3,"offset":0,"push":0,"pull":0,"currentWidth":3}],"key":"columns1","type":"columns","input":false,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":false,"hidden":false,"clearOnHide":false,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"tree":false,"lazyLoad":false,"autoAdjust":false,"id":"enq9a6f"}],"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"tree":true,"lazyLoad":false,"disableAddingRemovingRows":false,"removeRow":"Cancel","defaultOpen":false,"openWhenEmpty":false,"modal":false,"inlineEdit":false,"templates":{"header":"<div class=\"row\">\n      {% util.eachComponent(components, function(component) { %}\n        {% if (displayValue(component)) { %}\n          <div class=\"col-sm-2\">{{ t(component.label) }}</div>\n        {% } %}\n      {% }) %}\n    </div>","row":"<div class=\"row\">\n      {% util.eachComponent(components, function(component) { %}\n        {% if (displayValue(component)) { %}\n          <div class=\"col-sm-2\">\n            {{ isVisibleInRow(component) ? getView(component, row[component.key]) : ''}}\n          </div>\n        {% } %}\n      {% }) %}\n      {% if (!instance.options.readOnly && !instance.disabled) { %}\n        <div class=\"col-sm-2\">\n          <div class=\"btn-group pull-right\">\n            <button class=\"btn btn-default btn-light btn-sm editRow\"><i class=\"{{ iconClass('edit') }}\"></i></button>\n            {% if (!instance.hasRemoveButtons || instance.hasRemoveButtons()) { %}\n              <button class=\"btn btn-danger btn-sm removeRow\"><i class=\"{{ iconClass('trash') }}\"></i></button>\n            {% } %}\n          </div>\n        </div>\n      {% } %}\n    </div>","tableHeader":"\n      <tr>\n        {% util.eachComponent(components, function(component) { %}\n          {% if (!component.hasOwnProperty('tableView') || component.tableView) { %}\n            <td class=\"editgrid-table-column\">{{ component.label }}</td>\n          {% } %}\n        {% }) %}\n        {% if (!instance.options.readOnly && !instance.disabled) { %}\n          <td class=\"editgrid-table-column\">Actions</td>\n        {% } %}\n      </tr>\n    ","tableRow":"\n      {% util.eachComponent(components, function(component) { %}\n          {% if (!component.hasOwnProperty('tableView') || component.tableView) { %}\n            <td class=\"editgrid-table-column\">\n              {{ getView(component, row[component.key]) }}\n            </td>\n          {% } %}\n        {% }) %}\n        {% if (!instance.options.readOnly && !instance.disabled) { %}\n          <td class=\"editgrid-table-column\">\n            <div class=\"btn-group\">\n              <button class=\"btn btn-default btn-light btn-sm editRow\" aria-label=\"{{ t('Edit row') }}\"><i class=\"{{ iconClass('edit') }}\"></i></button>\n              {% if (!instance.hasRemoveButtons || instance.hasRemoveButtons()) { %}\n              <button class=\"btn btn-danger btn-sm removeRow\" aria-label=\"{{ t('Remove row') }}\"><i class=\"{{ iconClass('trash') }}\"></i></button>\n              {% } %}\n            </div>\n          </td>\n        {% } %}\n    ","footer":""},"id":"e7nj04r"}]},{"label":"Team","key":"team","components":[{"label":"Columns","columns":[{"components":[{"label":"EAO Team","labelPosition":"top","widget":"choicesjs","labelWidth":"","labelMargin":"","placeholder":"","description":"","tooltip":"","customClass":"","tabindex":"","hidden":false,"hideLabel":false,"uniqueOptions":false,"autofocus":false,"disabled":false,"tableView":true,"modalEdit":false,"multiple":false,"dataSrc":"url","data":{"values":[{"label":"","value":""}],"resource":"","json":"","url":"{{data.reportapiurl}}codes/eao_teams","headers":[{"key":"Authorization","value":"Bearer {{localStorage.getItem('authToken')}}"}],"custom":""},"dataType":"","idPath":"id","valueProperty":"id","limit":100,"template":"<span>{{ item.name }}</span>","refreshOn":"","refreshOnBlur":"","clearOnRefresh":false,"searchEnabled":true,"selectThreshold":0.3,"readOnlyValue":false,"customOptions":{},"useExactSearch":false,"persistent":true,"protected":false,"dbIndex":false,"encrypted":false,"clearOnHide":true,"customDefaultValue":"","calculateValue":"","calculateServer":false,"allowCalculateOverride":false,"validateOn":"change","validate":{"required":true,"onlyAvailableItems":false,"customMessage":"","custom":"","customPrivate":false,"json":"","strictDateValidation":false,"multiple":false,"unique":false},"unique":false,"errorLabel":"","errors":"","key":"works.eao_team_id","tags":[],"properties":{},"conditional":{"show":null,"when":null,"eq":"","json":""},"customConditional":"","logic":[],"attributes":{},"overlay":{"style":"","page":"","left":"","top":"","width":"","height":""},"type":"select","indexeddb":{"filter":{}},"selectValues":"codes","selectFields":"","searchField":"","searchDebounce":0.3,"minSearch":0,"filter":"","redrawOn":"","input":true,"disableLimit":false,"prefix":"","suffix":"","dataGridLabel":false,"showCharCount":false,"showWordCount":false,"allowMultipleMasks":false,"addons":[],"lazyLoad":true,"authenticate":false,"ignoreCache":false,"fuseOptions":{"include":"score","threshold":0.3},"id":"e9s5qur","defaultValue":"","sort":""}],"width":4,"offset":0,"push":0,"pull":0,"size":"md","currentWidth":4},{"components":[{"label":"Responsible EPD","labelPosition":"top","widget":"choicesjs","labelWidth":"","labelMargin":"","placeholder":"","description":"","tooltip":"","customClass":"","tabindex":"","hidden":false,"hideLabel":false,"uniqueOptions":false,"autofocus":false,"disabled":false,"tableView":true,"modalEdit":false,"multiple":false,"dataSrc":"url","data":{"values":[{"label":"","value":""}],"resource":"","json":"","url":"{{data.reportapiurl}}staffs/positions/3","headers":[{"key":"Authorization","value":"Bearer {{localStorage.getItem('authToken')}}"}],"custom":""},"dataType":"","idPath":"id","valueProperty":"id","limit":100,"template":"<span>{{ item.name }}</span>","refreshOn":"","refreshOnBlur":"","clearOnRefresh":false,"searchEnabled":true,"selectThreshold":0.3,"readOnlyValue":false,"customOptions":{},"useExactSearch":false,"persistent":true,"protected":false,"dbIndex":false,"encrypted":false,"clearOnHide":true,"customDefaultValue":"","calculateValue":"","calculateServer":false,"allowCalculateOverride":false,"validateOn":"change","validate":{"required":true,"onlyAvailableItems":false,"customMessage":"","custom":"","customPrivate":false,"json":"","strictDateValidation":false,"multiple":false,"unique":false},"unique":false,"errorLabel":"","errors":"","key":"works.responsible_epd_id","tags":[],"properties":{},"conditional":{"show":null,"when":null,"eq":"","json":""},"customConditional":"","logic":[],"attributes":{},"overlay":{"style":"","page":"","left":"","top":"","width":"","height":""},"type":"select","indexeddb":{"filter":{}},"selectValues":"staffs","selectFields":"","searchField":"","searchDebounce":0.3,"minSearch":0,"filter":"","redrawOn":"","input":true,"disableLimit":false,"prefix":"","suffix":"","dataGridLabel":false,"showCharCount":false,"showWordCount":false,"allowMultipleMasks":false,"addons":[],"lazyLoad":true,"authenticate":false,"ignoreCache":false,"fuseOptions":{"include":"score","threshold":0.3},"id":"ejido28","defaultValue":"","sort":""}],"width":4,"offset":0,"push":0,"pull":0,"size":"md","currentWidth":4},{"components":[{"label":"Work Lead","labelPosition":"top","widget":"choicesjs","labelWidth":"","labelMargin":"","placeholder":"","description":"","tooltip":"","customClass":"","tabindex":"","hidden":false,"hideLabel":false,"uniqueOptions":false,"autofocus":false,"disabled":false,"tableView":true,"modalEdit":false,"multiple":false,"dataSrc":"url","data":{"values":[{"label":"","value":""}],"resource":"","json":"","url":"{{data.reportapiurl}}staffs/positions/4","headers":[{"key":"Authorization","value":"Bearer {{localStorage.getItem('authToken')}}"}],"custom":""},"dataType":"","idPath":"id","valueProperty":"id","limit":100,"template":"<span>{{ item.name }}</span>","refreshOn":"","refreshOnBlur":"","clearOnRefresh":false,"searchEnabled":true,"selectThreshold":0.3,"readOnlyValue":false,"customOptions":{},"useExactSearch":false,"persistent":true,"protected":false,"dbIndex":false,"encrypted":false,"clearOnHide":true,"customDefaultValue":"","calculateValue":"","calculateServer":false,"allowCalculateOverride":false,"validateOn":"change","validate":{"required":true,"onlyAvailableItems":false,"customMessage":"","custom":"","customPrivate":false,"json":"","strictDateValidation":false,"multiple":false,"unique":false},"unique":false,"errorLabel":"","errors":"","key":"works.work_lead_id","tags":[],"properties":{},"conditional":{"show":null,"when":null,"eq":"","json":""},"customConditional":"","logic":[],"attributes":{},"overlay":{"style":"","page":"","left":"","top":"","width":"","height":""},"type":"select","indexeddb":{"filter":{}},"selectValues":"staffs","selectFields":"","searchField":"","searchDebounce":0.3,"minSearch":0,"filter":"","redrawOn":"","input":true,"disableLimit":false,"prefix":"","suffix":"","dataGridLabel":false,"showCharCount":false,"showWordCount":false,"allowMultipleMasks":false,"addons":[],"lazyLoad":true,"authenticate":false,"ignoreCache":false,"fuseOptions":{"include":"score","threshold":0.3},"id":"e4qdxd","defaultValue":"","sort":""}],"size":"md","width":4,"offset":0,"push":0,"pull":0,"currentWidth":4}],"key":"columns2","type":"columns","input":false,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":false,"hidden":false,"clearOnHide":false,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"tree":false,"lazyLoad":false,"autoAdjust":false,"id":"ey3aeg"},{"html":"<p>Team members for this work</p>","label":"Content","refreshOnChange":false,"key":"content","type":"content","input":false,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"id":"ewk3okr"},{"label":"Teams","reorder":false,"addAnotherPosition":"bottom","layoutFixed":false,"enableRowGroups":false,"initEmpty":true,"hideLabel":true,"tableView":false,"defaultValue":[{"staff_id":"","role_id":"","position":"","phone":"","email":"","id":""}],"calculateValue":"try{\r\n  for(var index = 0;index<submission.data['works-staff_work_roles'].length;index++) {\r\n    var result = instance.flattenComponents(index);\r\n    var staffs = data.onload.staffs;\r\n    if(staffs && staffs.length > 0) {\r\n      var staff = staffs.filter(p=>p.id==(data['works-staff_work_roles'][index]).staff_id)[0];\r\n\t\t  var position = result['position'];\r\n\t\t  var phone = result['phone'];\r\n\t      var email = result['email'];\r\n\t      position.setValue(staff?staff.position.name:'');\r\n\t      phone.setValue(staff?staff.phone:'');\r\n\t      email.setValue(staff?staff.email:'');\r\n    }\r\n  }\r\n}catch(e){\r\n  console.error(e.message);\r\n}","key":"works-staff_work_roles","type":"datagrid","input":true,"components":[{"label":"Team Member","widget":"choicesjs","tableView":true,"dataSrc":"custom","data":{"custom":"values = data.onload.staffs;","values":[{"label":"","value":""}],"json":"","url":"","resource":""},"valueProperty":"id","template":"<span>{{ item.name }}</span>","validate":{"required":true,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"onlyAvailableItems":false},"key":"staff_id","type":"select","input":true,"id":"e7xbcs60000000000000000000000000000000000000000000000000000000000","placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"idPath":"id","clearOnRefresh":false,"limit":100,"lazyLoad":true,"filter":"","searchEnabled":true,"searchDebounce":0.3,"searchField":"","minSearch":0,"readOnlyValue":false,"authenticate":false,"ignoreCache":false,"selectFields":"","selectThreshold":0.3,"uniqueOptions":false,"fuseOptions":{"include":"score","threshold":0.3},"indexeddb":{"filter":{}},"customOptions":{},"useExactSearch":false},{"label":"Role","labelPosition":"top","widget":"choicesjs","labelWidth":"","labelMargin":"","placeholder":"","description":"","tooltip":"","customClass":"","tabindex":"","hidden":false,"hideLabel":false,"uniqueOptions":false,"autofocus":false,"dataGridLabel":false,"disabled":false,"tableView":true,"modalEdit":false,"multiple":false,"dataSrc":"url","data":{"values":[{"label":"","value":""}],"resource":"","json":"","url":"{{data.reportapiurl}}codes/roles","headers":[{"key":"Authorization","value":"Bearer {{localStorage.getItem('authToken')}}"}],"custom":""},"dataType":"","idPath":"id","valueProperty":"id","limit":100,"template":"<span>{{ item.name }}</span>","refreshOn":"","refreshOnBlur":"","clearOnRefresh":false,"searchEnabled":true,"selectThreshold":0.3,"readOnlyValue":false,"customOptions":{},"useExactSearch":false,"persistent":true,"protected":false,"dbIndex":false,"encrypted":false,"clearOnHide":true,"customDefaultValue":"","calculateValue":"","calculateServer":false,"allowCalculateOverride":false,"validateOn":"change","validate":{"required":true,"onlyAvailableItems":false,"customMessage":"","custom":"","customPrivate":false,"json":"","strictDateValidation":false,"multiple":false,"unique":false},"unique":false,"errorLabel":"","errors":"","key":"role_id","tags":[],"properties":{},"conditional":{"show":null,"when":null,"eq":"","json":""},"customConditional":"","logic":[],"attributes":{},"overlay":{"style":"","page":"","left":"","top":"","width":"","height":""},"type":"select","indexeddb":{"filter":{}},"selectValues":"codes","selectFields":"","searchField":"","searchDebounce":0.3,"minSearch":0,"filter":"","redrawOn":"","input":true,"disableLimit":false,"prefix":"","suffix":"","showCharCount":false,"showWordCount":false,"allowMultipleMasks":false,"addons":[],"lazyLoad":true,"authenticate":false,"ignoreCache":false,"fuseOptions":{"include":"score","threshold":0.3},"id":"eq0egiq0000000000000000000000000000000000000000000000000000","defaultValue":"","sort":""},{"label":"Position","disabled":true,"tableView":true,"key":"position","type":"textfield","input":true,"id":"e7srgn0000000000000000000000000000000000000000000000000000000000","placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":""},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"plain","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false},{"label":"Phone","disabled":true,"tableView":true,"key":"phone","type":"textfield","input":true,"id":"eav0gcs0000000000000000000000000000000000000000000000000000000000","placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":""},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"plain","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false},{"label":"Email","disabled":true,"tableView":true,"key":"email","type":"textfield","input":true,"id":"ev60yor0000000000000000000000000000000000000000000000000000000000","placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"minLength":"","maxLength":"","pattern":""},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"mask":false,"inputType":"text","inputFormat":"plain","inputMask":"","displayMask":"","spellcheck":true,"truncateMultipleSpaces":false},{"label":"id","key":"id","type":"hidden","input":true,"tableView":false,"id":"eyl8k5d0000000000000000000000000000000000000000000000000000000000","placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden"}],"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"tree":true,"lazyLoad":false,"disableAddingRemovingRows":false,"id":"e65raz"}]},{"label":"PINs","key":"pin","components":[{"label":"PINGrid","reorder":false,"addAnotherPosition":"bottom","layoutFixed":false,"enableRowGroups":false,"initEmpty":true,"tableView":false,"defaultValue":[{"indigenous_nation_id":"","indigenous_category_id":"","id":""}],"key":"works-indigenous_works","type":"datagrid","input":true,"components":[{"label":"Indigenous Nation","widget":"choicesjs","tableView":true,"dataSrc":"url","data":{"url":"{{data.reportapiurl}}codes/indigenous_nations","headers":[{"key":"","value":""}],"values":[{"label":"","value":""}],"json":"","resource":"","custom":""},"valueProperty":"id","template":"<span>{{ item.name }}</span>","validate":{"required":true,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"onlyAvailableItems":false},"key":"indigenous_nation_id","type":"select","selectValues":"codes","input":true,"disableLimit":false,"id":"efzu0ym000000000000000000000000000000000000000000000000000000000","placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"idPath":"id","clearOnRefresh":false,"limit":100,"lazyLoad":true,"filter":"","searchEnabled":true,"searchDebounce":0.3,"searchField":"","minSearch":0,"readOnlyValue":false,"authenticate":false,"ignoreCache":false,"selectFields":"","selectThreshold":0.3,"uniqueOptions":false,"fuseOptions":{"include":"score","threshold":0.3},"indexeddb":{"filter":{}},"customOptions":{},"useExactSearch":false},{"label":"Indigenous Category","widget":"choicesjs","tableView":true,"dataSrc":"url","data":{"url":"{{data.reportapiurl}}codes/indigenous_categories","headers":[{"key":"","value":""}],"values":[{"label":"","value":""}],"json":"","resource":"","custom":""},"valueProperty":"id","template":"<span>{{ item.name }}</span>","validate":{"required":true,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false,"onlyAvailableItems":false},"key":"indigenous_category_id","type":"select","selectValues":"codes","input":true,"disableLimit":false,"id":"etgbxho000000000000000000000000000000000000000000000000000000000","placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"attributes":{},"validateOn":"change","conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"idPath":"id","clearOnRefresh":false,"limit":100,"lazyLoad":true,"filter":"","searchEnabled":true,"searchDebounce":0.3,"searchField":"","minSearch":0,"readOnlyValue":false,"authenticate":false,"ignoreCache":false,"selectFields":"","selectThreshold":0.3,"uniqueOptions":false,"fuseOptions":{"include":"score","threshold":0.3},"indexeddb":{"filter":{}},"customOptions":{},"useExactSearch":false},{"label":"id","key":"id","type":"hidden","input":true,"tableView":false,"id":"eq5fdr000000000000000000000000000000000000000000000000000000000","placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"inputType":"hidden"}],"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"protected":false,"unique":false,"persistent":true,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"tree":true,"lazyLoad":false,"disableAddingRemovingRows":false,"id":"er0yib"}]}],"key":"tabs1","type":"tabs","input":false,"tableView":false,"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":false,"hidden":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"tree":false,"lazyLoad":false,"verticalLayout":false,"id":"ey1pxb"}],"placeholder":"","prefix":"","customClass":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":false,"hidden":false,"clearOnHide":false,"refreshOn":"","redrawOn":"","modalEdit":false,"dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":null,"attributes":{},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"overlay":{"style":"","left":"","top":"","width":"","height":""},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"properties":{},"allowMultipleMasks":false,"addons":[],"tree":false,"lazyLoad":false,"theme":"default","breadcrumb":"default","id":"ejt1tl"},{"label":"Submit","labelWidth":"","labelMargin":"","action":"custom","showValidations":true,"theme":"primary","size":"md","block":false,"leftIcon":"fa fa-save","rightIcon":"","shortcut":"","description":"","tooltip":"","customClass":"","tabindex":"","disableOnInvalid":false,"hidden":false,"autofocus":false,"disabled":false,"tableView":false,"modalEdit":false,"key":"alternatesubmit","tags":[],"properties":{},"conditional":{"show":null,"when":null,"eq":"","json":""},"customConditional":"show = Boolean(data.applicationId)","logic":[],"attributes":{},"overlay":{"style":"","page":"","left":"","top":"","width":"","height":""},"type":"button","custom":"form.emit('submitButton', {\r\n          state: instance.component.state || 'submitted',\r\n          component: instance.component,\r\n          instance: instance\r\n        });\r\n// if(form.isValid()) {\r\n// const submissionId = form._submission._id;\r\n// const formDataReqUrl = form.formio.formUrl+'/submission/'+submissionId;\r\n// const formDataReqObj1 =  {  \"_id\": submissionId,  \"data\": data};\r\n// const formio = new Formio(formDataReqUrl);\r\n// formio.saveSubmission(formDataReqObj1).then( result => {\r\n  \r\n// form.emit('customEvent', {\r\n//           type: \"actionComplete\",   \r\n//           component: component,\r\n//           actionType:data.actionType\r\n//     }); \r\n// window.reload();\r\n// }).catch((error)=>{\r\n// //Error callback on not Save\r\n\r\n// });\r\n// }\r\n","input":true,"placeholder":"","prefix":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","dataGridLabel":true,"labelPosition":"top","errorLabel":"","hideLabel":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"allowMultipleMasks":false,"addons":[],"id":"eslir"},{"label":"Submit","labelWidth":"","labelMargin":"","action":"submit","showValidations":false,"theme":"primary","size":"md","block":false,"leftIcon":"fa fa-save","rightIcon":"","shortcut":"","description":"","tooltip":"","customClass":"","tabindex":"","disableOnInvalid":false,"hidden":false,"autofocus":false,"disabled":false,"tableView":false,"modalEdit":false,"key":"submit","tags":[],"properties":{},"conditional":{"show":null,"when":null,"eq":"","json":""},"customConditional":"show = !Boolean(data.applicationId)","logic":[],"attributes":{},"overlay":{"style":"","page":"","left":"","top":"","width":"","height":""},"type":"button","input":true,"saveOnEnter":false,"placeholder":"","prefix":"","suffix":"","multiple":false,"defaultValue":null,"protected":false,"unique":false,"persistent":false,"clearOnHide":true,"refreshOn":"","redrawOn":"","dataGridLabel":true,"labelPosition":"top","errorLabel":"","hideLabel":false,"dbIndex":false,"customDefaultValue":"","calculateValue":"","calculateServer":false,"widget":{"type":"input"},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"allowCalculateOverride":false,"encrypted":false,"showCharCount":false,"showWordCount":false,"allowMultipleMasks":false,"addons":[],"id":"ez4cf7r"},{"label":"applicationId","customClass":"","modalEdit":false,"persistent":true,"protected":false,"dbIndex":false,"encrypted":false,"redrawOn":"","customDefaultValue":"","calculateValue":"","calculateServer":false,"key":"applicationId","tags":[],"properties":{},"logic":[],"attributes":{},"overlay":{"style":"","page":"","left":"","top":"","width":"","height":""},"type":"hidden","input":true,"placeholder":"","prefix":"","suffix":"","multiple":false,"unique":false,"hidden":false,"clearOnHide":true,"refreshOn":"","tableView":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"widget":{"type":"input"},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"allowCalculateOverride":false,"showCharCount":false,"showWordCount":false,"allowMultipleMasks":false,"inputType":"hidden","id":"em1y8gd","defaultValue":"","dataGridLabel":false,"addons":[]},{"label":"applicationStatus","customClass":"","modalEdit":false,"defaultValue":null,"persistent":true,"protected":false,"dbIndex":false,"encrypted":false,"redrawOn":"","customDefaultValue":"","calculateValue":"","calculateServer":false,"key":"applicationStatus","tags":[],"properties":{},"logic":[],"attributes":{},"overlay":{"style":"","page":"","left":"","top":"","width":"","height":""},"type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","suffix":"","multiple":false,"unique":false,"hidden":false,"clearOnHide":true,"refreshOn":"","dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"widget":{"type":"input"},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"allowCalculateOverride":false,"showCharCount":false,"showWordCount":false,"allowMultipleMasks":false,"inputType":"hidden","id":"e6z1qd9","addons":[]},{"label":"actionType ","labelWidth":"","labelMargin":"","customClass":"","modalEdit":false,"defaultValue":"0","persistent":true,"protected":false,"dbIndex":false,"encrypted":false,"redrawOn":"","customDefaultValue":"","calculateValue":"value = parseInt(value);","calculateServer":false,"key":"actionType","tags":[],"properties":{},"logic":[],"attributes":{},"overlay":{"style":"","page":"","left":"","top":"","width":"","height":""},"type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","suffix":"","multiple":false,"unique":false,"hidden":false,"clearOnHide":true,"refreshOn":"","dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"widget":{"type":"input"},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"allowCalculateOverride":false,"showCharCount":false,"showWordCount":false,"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"ehty36b"},{"label":"isWorkTerminated","labelWidth":"","labelMargin":"","customClass":"","modalEdit":false,"defaultValue":null,"persistent":true,"protected":false,"dbIndex":false,"encrypted":false,"redrawOn":"","customDefaultValue":"value = false;","calculateValue":"","calculateServer":false,"key":"isworkterminated","tags":[],"properties":{},"logic":[{"name":"isWorkTerminatedFlagChangeLogic","trigger":{"type":"event","event":"change"},"actions":[{"name":"isWorkTerminatedFlagChangeAction","type":"customAction","customAction":"var events = submission.data['works-events'];\nconsole.log('termination change');\nvar outcomes = data.onload.outcomes;\nfor(var i = 0;i < events.length; i++) {\n  var event = events[i];\n        if (event.decision_id !== \"\" && event.is_active === true) {\n            var outcome = outcomes.filter(p => p.id === parseInt(event.decision_id));\n            if (outcome.length > 0 && outcome[0].terminates_work === true){\n                    data.isworkterminated = true;\n                    break;\n            }else{\n              data.isworkterminated = false;\n            } \n            }else{\n          data.isworkterminated = false;\n        }\n        \n}"}]}],"attributes":{},"overlay":{"style":"","page":"","left":"","top":"","width":"","height":""},"type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","suffix":"","multiple":false,"unique":false,"hidden":false,"clearOnHide":true,"refreshOn":"","dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"widget":{"type":"input"},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"allowCalculateOverride":false,"showCharCount":false,"showWordCount":false,"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"evqolfr"},{"label":"activePhase","labelWidth":"","labelMargin":"","customClass":"","modalEdit":false,"defaultValue":"0","persistent":true,"protected":false,"dbIndex":false,"encrypted":false,"redrawOn":"","customDefaultValue":"","calculateValue":"value = parseInt(value);","calculateServer":false,"key":"activephase","tags":[],"properties":{},"logic":[],"attributes":{},"overlay":{"style":"","page":"","left":"","top":"","width":"","height":""},"type":"hidden","input":true,"tableView":false,"placeholder":"","prefix":"","suffix":"","multiple":false,"unique":false,"hidden":false,"clearOnHide":true,"refreshOn":"","dataGridLabel":false,"labelPosition":"top","description":"","errorLabel":"","tooltip":"","hideLabel":false,"tabindex":"","disabled":false,"autofocus":false,"widget":{"type":"input"},"validateOn":"change","validate":{"required":false,"custom":"","customPrivate":false,"strictDateValidation":false,"multiple":false,"unique":false},"conditional":{"show":null,"when":null,"eq":""},"allowCalculateOverride":false,"showCharCount":false,"showWordCount":false,"allowMultipleMasks":false,"addons":[],"inputType":"hidden","id":"ef7c4wl"}]}]}